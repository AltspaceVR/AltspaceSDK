!function(e){"use strict";function t(e){var n={};return n=e.__proto__?Object.assign(t(e.__proto__),e):Object.assign({schema:{},dependencies:[]},e),e.schema&&Object.assign(n.schema,e.schema),e.dependencies&&(o=n.dependencies).push.apply(o,e.dependencies),n;var o}function n(e,n){AFRAME.registerComponent(e,t(new n(!0)))}function o(e,n){AFRAME.registerSystem(e,t(new n(!0)))}function i(e,t,n){return 0===t.length?n:(e[t[0]]=i(e[t[0]]||{},t.slice(1),n),e)}function a(e){return e?encodeURIComponent(e).replace(/\./g,"%2E").replace(/%[A-Z0-9]{2}/g,"-"):null}function s(){var e=document.querySelector("link[rel=canonical]");return e?e.href:window.location.href}function r(e,t,n){return a(t||n)+":"+a(e||"")}function c(e){function t(){var t={},n=r(e.appId,e.authorId,N);t.app=s.child(n).child("app"),t.space=l?t.app.child("spaces").child(l):null,t.user=d?t.app.child("users").child(d):null;var o=t.app.child("instances");return c?t.instance=o.child(c):(t.instance=o.push(),c=t.instance.key()),t}function n(){o.query["altspace-sync-instance"]||(o.query["altspace-sync-instance"]=c,window.location.href=o.toString())}e=e||{};var o=new Url,i=e.baseRefUrl||"https://altspace-apps.firebaseio.com/apps/examples/",s=new q(i),c=e.instanceId||o.query["altspace-sync-instance"],l=e.spaceId||o.query["altspace-sync-space"],d=e.userId||o.query["altspace-sync-user"];if(!e.appId||!e.authorId)throw new Error("Both the appId and authorId must be provided to connect.");var p=[];return z&&(l||p.unshift(altspace.getSpace()),d||p.unshift(altspace.getUser())),Promise.all(p).then(function(e){z&&(l||(l=e.pop().sid),d||(d=e.pop().userId)),l=a(l),d=a(d),c=a(c);var o=t();return n(),o})}function l(e,t,n){if(!e||!e instanceof THREE.Scene)throw new TypeError("Requires THREE.Scene argument");if(!t||!t instanceof THREE.Camera)throw new TypeError("Requires THREE.Camera argument");x=e,F=t,p=n||{},B=p.renderer&&p.renderer.domElement||window,B.addEventListener("mousedown",d,!1),B.addEventListener("mouseup",u,!1),B.addEventListener("mousemove",h,!1)}function d(e){var t=v(e);if(t&&t.point){var n=f("cursordown",t);t.object.dispatchEvent(n)}}function u(e){var t=v(e),n=f("cursorup",t);t?t.object.dispatchEvent(n):x.dispatchEvent(n)}function h(e){var t=v(e),n=f("cursormove",t);x.dispatchEvent(n);var o=t?t.object:null;P!=o&&(P&&(n=f("cursorleave",t),P.dispatchEvent(n)),o&&(n=f("cursorenter",t),o.dispatchEvent(n)),P=o)}function f(e,t){return{type:e,bubbles:!0,target:t?t.object:null,ray:{origin:G.ray.origin.clone(),direction:G.ray.direction.clone()},point:t?t.point.clone():null}}function v(e){var t=new THREE.Vector2;t.x=e.offsetX/(B.width||B.innerWidth)*2-1,t.y=2*-(e.offsetY/(B.height||B.innerHeight))+1,G.setFromCamera(t,F);var n=G.intersectObjects(x.children,!0);return n.find(function(e){return!e.object.userData||!e.object.userData.altspace||!e.object.userData.altspace.collider||e.object.userData.altspace.collider.enabled!==!1})||null}function m(){var e,t=[],n=[],o=[],i=0;return{objUrls:t,mtlUrls:n,objects:o,error:e,objectsLoaded:i}}function y(e){var t=e||{};Z=t.TRACE||!1,t.crossOrigin&&(Q=t.crossOrigin),t.baseUrl&&(K=t.baseUrl),"/"!==K.slice(-1)&&(K+="/"),Y=new altspace.utilities.shims.OBJMTLLoader,Y.crossOrigin=Q,Z&&console.log("MultiLoader initialized with params",e)}function g(e,t){var n=e,o=Date.now();if(!n||!n instanceof m)throw new Error("MultiLoader.load expects first arg of type LoadRequest");if(!t||"function"!=typeof t)throw new Error("MultiLoader.load expects second arg of type function");if(!n.objUrls||!n.mtlUrls||n.objUrls.length!==n.mtlUrls.length)throw new Error("MultiLoader.load called with bad LoadRequest");var i=n.objUrls.length;Z&&console.log("Loading models...");for(var a=0;a<i;a++){var s=function(e,n){var a=K+e.objUrls[n],s=K+e.mtlUrls[n];Z&&console.log("Loading obj:"+a+", mtl:"+s),Y.load(a,s,function(a){if(e.objects[n]=a,e.objectsLoaded++,e.objectsLoaded===i){var s=((Date.now()-o)/1e3).toFixed(2);Z&&console.log("Loaded "+i+" models in "+s+" seconds"),t()}},b,function(){var t=xhr.target.responseURL||"";e.error="Error loading file "+t})};s(n,a)}}function b(e){if(e.lengthComputable&&e.target.responseURL){var t=e.loaded/e.total*100,n=e.target.responseURL.split("/").pop();Z&&console.log("..."+n+" "+Math.round(t,2)+"% downloaded")}}function E(){console.log("In a tile: "+oe),console.log("In VR: "+ie)}function w(){if(!oe&&ie);else{var e=document.createElement("style");e.type="text/css",e.innerHTML="@import url(https://fonts.googleapis.com/css?family=Open+Sans:800);.altspace-info{text-align:center;font-family:'Open Sans',sans-serif;line-height:.5}.altspace-vr-notice{color:rgba(0,0,0,.7);font-size:5vw}.altspace-pen-name{font-size:7vw}",document.head.appendChild(e),document.body.style.background=ee.make_color({seed:L()});var t=document.createElement("div");t.className="altspace-info",document.body.appendChild(t);var n=document.createElement("span");if(n.className="altspace-pen-name",n.innerHTML="<p>"+ne.toUpperCase()+"</p>",t.appendChild(n),oe){var o="VR mode does not support preview tiles. Stopping code execution.";throw console.log("ERROR: "+o),new Error(o)}if(!ie){var i=document.createElement("span");i.className="altspace-vr-notice",i.innerHTML="<p>View</p>",t.insertBefore(i,n);var a=document.createElement("span");a.className="altspace-vr-notice",a.innerHTML='<p>in <a href="http://altvr.com"> AltspaceVR </a></p>',t.appendChild(a);var o="Not in VR mode. Stopping code execution.";throw oe&&console.log("ERROR: "+o),new Error(o)}}}function _(e){ne=e}function R(){var e=document.querySelector("link[rel=canonical]"),t=e?e.href:window.location.href;return new te(t)}function L(){var e=R(),t=e.path.split("/"),n=t[t.length-1];return n}function C(){var e=R(),t=e.path.split("/"),n="team"==t[1],o=n?"team-"+t[2]:t[1];return o}function j(e){var t,n,o=this;if(e.bubbles&&(e.currentTarget=this,e.stopPropagation=function(){t=!0},e.stopImmediatePropagation=function(){n=!0}),this._listeners){var i=this._listeners,a=i[e.type];if(a){e.target=e.target||this;for(var s=[],r=a.length,c=0;c<r;c++)s[c]=a[c];for(var c=0;c<r;c++)if(s[c].call(o,e),n)return}}e.bubbles&&this.parent&&this.parent.dispatchEvent&&!t&&j.call(this.parent,e)}var O=function(){},S={schema:{}};S.schema.get=function(){return null},O.prototype.init=function(){},O.prototype.tick=function(e,t){},O.prototype.pause=function(){},O.prototype.play=function(){},Object.defineProperties(O.prototype,S);var T=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.update=function(e){},t.prototype.remove=function(){},t.prototype.updateSchema=function(e){},t}(O),M=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={schema:{}};return n.schema.get=function(){return{enabled:{type:"boolean",default:"true"}}},t.prototype.init=function(){var e=this;this.setColliderFlag(this.data.enabled),this.el.addEventListener("model-loaded",function(){e.setColliderFlag(e.data.enabled)}.bind(this))},t.prototype.update=function(){this.setColliderFlag(this.data.enabled)},t.prototype.setColliderFlag=function(e){var t=this.el.object3D;t&&(console.log("Setting collider flag to",e),i(t.userData,["altspace","collider","enabled"],e),t.traverse(function(t){t instanceof THREE.Mesh&&i(t.userData,["altspace","collider","enabled"],e)}))},Object.defineProperties(t.prototype,n),t}(T),A=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.init=function(){this.gamepadIndex=null,this.trackedControlsSystem=document.querySelector("a-scene").systems["tracked-controls"],this.systemGamepads=0,altspace.getGamepads()},t.prototype.tick=function(){if(this.trackedControlsSystem&&this.systemGamepads!==this.trackedControlsSystem.controllers.length&&window.altspace&&altspace.getGamepads&&altspace.getGamepads().length){var e=this.el.components;e["paint-controls"]&&(this.gamepadIndex="left"===e["paint-controls"].data.hand?2:1),null===this.gamepadIndex&&e["hand-controls"]&&(this.gamepadIndex="left"===e["hand-controls"].data?2:1),null===this.gamepadIndex&&e["vive-controls"]&&(this.gamepadIndex="left"===e["vive-controls"].data.hand?2:1),null===this.gamepadIndex&&e["tracked-controls"]&&(this.gamepadIndex=e["tracked-controls"].data.controller),this.el.setAttribute("tracked-controls","id",altspace.getGamepads()[this.gamepadIndex].id),this.el.setAttribute("tracked-controls","controller",0),this.systemGamepads=this.trackedControlsSystem.controllers.length}},t}(T),D=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={schema:{}};return n.schema.get=function(){return{usePixelScale:{type:"boolean",default:"false"},verticalAlign:{type:"string",default:"middle"},enclosuresOnly:{type:"boolean",default:"true"},fullspace:{type:"boolean",default:"false"}}},t.prototype.init=function(){return this.version="AFRAME_ALTSPACE_VERSION",!this.el.object3D instanceof THREE.Scene?void console.warn("aframe-altspace-component can only be attached to a-scene"):void(window.altspace&&window.altspace.inClient?(this.el.setAttribute("vr-mode-ui",{enabled:!1}),this.initRenderer(),this.initCursorEvents(),this.initCollisionEvents()):console.warn("aframe-altspace-component only works inside of AltspaceVR"))},t.prototype.tick=function(e,t){this.el.object3D.updateAllBehaviors&&this.el.object3D.updateAllBehaviors()},t.prototype.initRenderer=function(){var e=this,t=this.el.object3D;altspace.getEnclosure().then(function(o){switch(e.data.fullspace&&(o.requestFullspace(),o.addEventListener("fullspacechange",function(){t.scale.setScalar(o.pixelsPerMeter)})),e.data.usePixelScale&&!e.data.fullspace||t.scale.setScalar(o.pixelsPerMeter),e.data.verticalAlign){case"bottom":t.position.y-=o.innerHeight/2;break;case"top":t.position.y+=o.innerHeight/2;break;case"middle":break;default:console.warn("Unexpected value for verticalAlign: ",e.data.verticalAlign)}e.data.enclosuresOnly&&1===o.innerDepth&&(e.el.renderer.render(new THREE.Scene),e.el.renderer=e.el.effect=n)}.bind(this));var n=this.el.renderer,o=this.el.renderer=this.el.effect=altspace.getThreeJSRenderer({aframeComponentVersion:this.version}),i=function(){};o.setSize=i,o.setPixelRatio=i,o.setClearColor=i,o.clear=i,o.enableScissorTest=i,o.setScissor=i,o.setViewport=i,o.getPixelRatio=i,o.getMaxAnisotropy=i,o.setFaceCulling=i,o.context={canvas:{}},o.shadowMap={}},t.prototype.initCursorEvents=function(){function e(e,t){var o=t.target.el;n&&n.emit(e,{target:o,ray:t.ray,point:t.point}),o&&o.emit(e,{target:o,ray:t.ray,point:t.point})}var t=this.el.object3D,n=document.querySelector("a-cursor")||document.querySelector("a-entity[cursor]");n&&(n.setAttribute("material","transparent",!0),n.setAttribute("material","opacity",0));var o=null;t.addEventListener("cursordown",function(t){o=t.target,e("mousedown",t)}),t.addEventListener("cursorup",function(t){e("mouseup",t),t.target.uuid===o.uuid&&e("click",t),o=null}),t.addEventListener("cursorenter",function(t){t.target.el&&(t.target.el.addState("hovered"),n&&n.addState("hovering"),e("mouseenter",t))}),t.addEventListener("cursorleave",function(t){t.target.el&&(t.target.el.removeState("hovered"),n&&n.removeState("hovering"),e("mouseleave",t))})},t.prototype.initCollisionEvents=function(){function e(e,t){var n=t.target.el;n&&(t.target=n,t.other&&t.other.el&&(t.other=t.other.el),n.emit(e,t))}var t=this.el.object3D;t.addEventListener("collisionenter",function(t){e("collisionenter",t)}),t.addEventListener("collisionexit",function(t){e("collisionexit",t)}),t.addEventListener("triggerenter",function(t){e("triggerenter",t)}),t.addEventListener("triggerexit",function(t){e("triggerexit",t)})},Object.defineProperties(t.prototype,n),t}(T),I=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={dependencies:{}};return n.dependencies.get=function(){return["sync"]},t.prototype.init=function(){this.sync=this.el.components.sync,this.sync.isConnected?start():this.el.addEventListener("connected",this.start.bind(this))},t.prototype.start=function(){var e=this.sync.dataRef.child("material/color"),t=!1,n=!0;component.el.addEventListener("componentchanged",function(n){var o=n.detail.name,i=n.detail.oldData,a=n.detail.newData;"material"===o&&!t&&i.color!==a.color&&sync.isMine&&setTimeout(function(){return e.set(a.color)},0)}),e.on("value",function(e){if(!sync.isMine||n){var o=e.val();t=!0,component.el.setAttribute("material","color",o),t=!1,n=!1}})},Object.defineProperties(t.prototype,n),t}(T),H=function(e){function t(e){void 0===e&&(e=!1),this._isComponent=e,this.scene=void 0,this.syncSys=void 0,this.ref=void 0,this.key=void 0,this.dataRef=void 0,this.ownerRef=void 0,this.ownerId=void 0,this.isConnected=!1,this.isMine=!1}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={schema:{}};return n.schema.get=function(){return{mode:{default:"link"},ownOn:{type:"string"}}},t.prototype.init=function(){var e=this;if(this.scene=this.el.sceneEl,this.syncSys=this.scene.systems["sync-system"],this.syncSys.isConnected?start():this.scene.addEventListener("connected",this.start.bind(this)),this.data.ownOn){var t=this.data.ownOn.split(/[ ,]+/);t.forEach(function(t){e.el.addEventListener(t,function(){e.isConnected&&e.takeOwnership()}.bind(e))}.bind(this))}},t.prototype.takeOwnership=function(){this.ownerRef.set(this.syncSys.clientId),this.ownerRef.onDisconnect().set(null)},t.prototype.start=function(){var e=this;if(this.scene.addEventListener("clientleft",function(t){var n=(!ownerId||ownerId===t.detail.id)&&e.syncSys.isMasterClient;n&&e.takeOwnership()}.bind(this)),"link"!==this.data.mode)return void console.error("Unsupported sync mode: "+this.data.mode);var t=this.el.id;return t?(console.log("syncSys: "+this.syncSys),console.log("syncSys.sceneRef: "+this.syncSys.sceneRef),this.link(this.syncSys.sceneRef.child(t)),this.setupReceive(),this.isConnected=!0,void this.el.emit("connected",null,!1)):void console.error("Entities cannot be synced using link mode without an id.")},t.prototype.link=function(e){this.ref=e,this.key=this.ref.key(),this.dataRef=this.ref.child("data"),this.ownerRef=this.ref.child("owner")},t.prototype.setupReceive=function(){var e=this;this.ownerRef.transaction(function(t){if(!t)return e.ownerRef.onDisconnect().set(null),e.syncSys.clientId}.bind(this)),this.ownerRef.on("value",function(t){var n=t.val(),o=n===e.syncSys.clientId&&!e.isMine;o&&e.el.emit("ownershipgained",null,!1);var i=n!==e.syncSys.clientId&&e.isMine;i&&(e.el.emit("ownershiplost",null,!1),e.ownerRef.onDisconnect().cancel()),e.ownerId=n,e.isMine=n===e.syncSys.clientId}.bind(this))},Object.defineProperties(t.prototype,n),t}(T),k=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={schema:{}};return n.schema.get=function(){return{author:{type:"string",default:null},app:{type:"string",default:null},instance:{type:"string",default:null},refUrl:{type:"string",default:null}}},t.prototype.init=function(){return this.data&&this.data.app?(console.log(this.data),this.isConnected=!1,void altspace.utilities.sync.connect({authorId:this.data.author,appId:this.data.app,instanceId:this.data.instance,baseRefUrl:this.data.refUrl}).then(this.connected.bind(this))):void console.warn("The sync-system must be present on the scene and configured with required data.")},t.prototype.connected=function(e){this.connection=e,this.sceneRef=this.connection.instance.child("scene"),this.clientsRef=this.connection.instance.child("clients"),this.clientId=this.sceneEl.object3D.uuid,this.masterClientId=null;var t=this;this.clientsRef.on("value",function(e){var n=e.val(),o=Object.keys(n)[0];t.masterClientId=n[o]}),this.clientsRef.on("child_added",function(e){var n=e.val();setTimeout(function(){t.sceneEl.emit("clientjoined",{id:n},!1)},0)}),this.clientsRef.on("child_removed",function(e){var n=e.val();setTimeout(function(){t.sceneEl.emit("clientleft",{id:n},!1)},0)}),this.clientsRef.push(this.clientId).onDisconnect().remove(),this.connection.instance.child("initialized").once("value",function(e){var n=!e.val();e.ref().set(!0),t.sceneEl.emit("connected",{shouldInitialize:n},!1),t.isConnected=!0})},t.prototype.isMasterClient=function(){return this.masterClientId===this.clientId},Object.defineProperties(t.prototype,n),t}(O);AFRAME.registerComponent("sync-transform",{dependencies:["sync"],schema:{},init:function(){function e(){function e(e,o){if(!n.isMine){var i=e.val();i&&t.el.setAttribute(o,i)}}function o(e){if(n.isMine){var t=e.detail.name,o=e.detail.newData;if("position"===t)l(o);else if("rotation"===t)d(o);else{if("scale"!==t)return;p(o)}}}function i(e,t,n){var o,i,a,s,r=0;n||(n={});var c=function(){r=n.leading===!1?0:Date.now(),o=null,s=e.apply(i,a),o||(i=a=null)},l=function(){var l=Date.now();r||n.leading!==!1||(r=l);var d=t-(l-r);return i=this,a=arguments,d<=0||d>t?(o&&(clearTimeout(o),o=null),r=l,s=e.apply(i,a),o||(i=a=null)):o||n.trailing===!1||(o=setTimeout(c,d)),s};return l.cancel=function(){clearTimeout(o),r=0,o=i=a=null},l}var a=n.dataRef.child("position"),s=n.dataRef.child("rotation"),r=n.dataRef.child("scale");t.updateRate=100;var c=[];t.el.addEventListener("ownershiplost",function(){for(var e=t.el.children,n=0;n<e.length;n++){var o=e[n].tagName.toLowerCase();"a-animation"===o&&(c.push(e[n]),e[n].stop())}}),t.el.addEventListener("ownershipgained",function(){for(var e=0;e<c.length;e++){var t=c[e];t.start()}c=[]}),a.on("value",function(t){e(t,"position")}),s.on("value",function(t){e(t,"rotation")}),r.on("value",function(t){e(t,"scale")});var l=i(function(e){a.set(e)},t.updateRate),d=i(function(e){s.set(e)},t.updateRate),p=i(function(e){r.set(e)},t.updateRate);t.el.addEventListener("componentchanged",o)}var t=this,n=t.el.components.sync;n.isConnected?e():t.el.addEventListener("connected",e)}});(function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={dependencies:{}};return n.dependencies.get=function(){return["sync"]},Object.defineProperties(t.prototype,n),t})(T);AFRAME.registerComponent("sync-n-sound",{dependencies:["sync"],schema:{},init:function(){function e(){function e(e){if(n.isMine){var e={type:e.type,sender:i.clientId,el:t.el.id,time:Date.now()};t.soundEventRef.set(e)}}t.soundStateRef=n.dataRef.child("sound/state"),t.soundEventRef=n.dataRef.child("sound/event"),t.el.addEventListener("sound-played",e),t.el.addEventListener("sound-paused",e),t.soundEventRef.on("value",function(e){if(!n.isMine){var o=e.val();if(o&&o.el===t.el.id){var i=t.el.components["n-sound"];"sound-played"===o.type?i.playSound():i.pauseSound()}}}),t.el.addEventListener("componentchanged",function(e){if(n.isMine){var o=e.detail.name;"n-sound"===o&&t.soundStateRef.set(e.detail.newData)}}),t.soundStateRef.on("value",function(e){if(!n.isMine){var o=e.val();o&&t.el.setAttribute("n-sound",o)}})}var t=this,n=t.el.components.sync,o=document.querySelector("a-scene"),i=o.systems["sync-system"];n.isConnected?e():t.el.addEventListener("connected",e)},remove:function(){this.soundStateRef.off("value"),this.soundEventRef.off("value")}}),function(){function e(e){e.userData.altspace=e.userData.altspace||{},e.userData.altspace.collider=e.userData.altspace.collider||{},e.userData.altspace.collider.enabled=!1,altspace.addNativeComponent(e,this.name)}function t(){var t=this.el.getOrCreateObject3D("mesh",c);e.call(this,t),this.update(this.data)}function n(){var e=this.el.getObject3D("mesh");altspace.removeNativeComponent(e,this.name)}function o(e){altspace.updateNativeComponent(this.el.object3DMap.mesh,this.name,this.data)}function i(e,t){altspace.callNativeComponent(this.el.object3DMap.mesh,this.name,e,t)}if(!window.altspace||!altspace.inClient){var a=function(){};window.altspace={addNativeComponent:a,updateNativeComponent:a,removeNativeComponent:a}}var s=new THREE.BoxGeometry(.001,.001,.001),r=new THREE.MeshBasicMaterial({color:0});r.visible=!1;var c=function(){THREE.Mesh.call(this,s,r)};c.prototype=Object.create(THREE.Mesh.prototype),c.prototype.constructor=THREE.PlaceholderMesh,AFRAME.registerComponent("n-object",{schema:{res:{type:"string"}},init:t,update:o,remove:n}),AFRAME.registerComponent("n-spawner",{schema:{res:{type:"string"}},init:t,update:o,remove:n}),AFRAME.registerComponent("n-text",{init:t,update:o,remove:n,schema:{text:{default:"",type:"string"},fontSize:{default:"10",type:"int"},width:{default:"10",type:"number"},height:{default:"1",type:"number"},horizontalAlign:{default:"middle"},verticalAlign:{default:"middle"}}}),AFRAME.registerComponent("n-sphere-collider",{init:t,remove:n,update:o,schema:{isTrigger:{default:!1,type:"boolean"},center:{type:"vec3"},radius:{default:"0",type:"number"},type:{default:"object"}}}),AFRAME.registerComponent("n-box-collider",{init:t,remove:n,update:o,schema:{isTrigger:{default:!1,type:"boolean"},center:{type:"vec3"},size:{type:"vec3"},type:{default:"object"}}}),AFRAME.registerComponent("n-capsule-collider",{init:t,remove:n,update:o,schema:{isTrigger:{default:!1,type:"boolean"},center:{type:"vec3"},radius:{default:"0",type:"number"},height:{default:"0",type:"number"},direction:{default:"y"},type:{default:"object"}}}),AFRAME.registerComponent("n-mesh-collider",{_forEachMesh:function(e){var t=this.el.object3DMap.mesh;t&&(t instanceof THREE.Mesh&&e(t),t.traverse(function(t){t instanceof THREE.Mesh&&e(t)}.bind(this)))},_initObj:function(){this._forEachMesh(function(t){e.call(this,t),altspace.updateNativeComponent(t,this.name,this.data)}.bind(this))},init:function(){this.el.getOrCreateObject3D("mesh",c),this._initObj(),this.el.addEventListener("model-loaded",function(){this._initObj()}.bind(this))},remove:function(){this._forEachMesh(function(e){altspace.removeNativeComponent(e,this.name)}.bind(this))},update:function(e){this._forEachMesh(function(e){altspace.updateNativeComponent(e,this.name,this.data)}.bind(this))},schema:{isTrigger:{default:!1,type:"boolean"},convex:{default:!0,type:"boolean"},type:{default:"object"}}}),AFRAME.registerComponent("n-billboard",{init:t,remove:n}),AFRAME.registerComponent("n-container",{init:function(){t.call(this);var e=this.el,n=this;e.addEventListener("stateadded",function(t){"container-full"===t.detail.state&&e.emit("container-full"),"container-empty"===t.detail.state&&e.emit("container-empty")}),e.addEventListener("container-count-changed",function(e){n.count=e.detail.count})},remove:n,update:o,schema:{capacity:{default:4,type:"number"}}}),AFRAME.registerComponent("n-sound",{init:function(){var e=this.data.src;if(e&&!e.startsWith("http"))if(e.startsWith("/"))this.data.src=location.origin+e;else{var n=location.pathname;n.endsWith("/")||(n=location.pathname.split("/").slice(0,-1).join("/")+"/"),this.data.src=location.origin+n+e}t.call(this)},pauseSound:function(){i.call(this,"pause"),this.el.emit("sound-paused")},playSound:function(){i.call(this,"play"),this.el.emit("sound-played")},seek:function(e){i.call(this,"seek",{time:e})},remove:function(){n.call(this),this.playHandler&&this.el.removeEventListener(oldData.on,this.playHandler)},update:function(e){o.call(this,e),this.playHandler&&this.el.removeEventListener(e.on,this.playHandler),this.data.on&&(this.playHandler=this.playSound.bind(this),this.el.addEventListener(this.data.on,this.playHandler))},schema:{on:{type:"string"},res:{type:"string"},src:{type:"string"},loop:{type:"boolean"},volume:{type:"number",default:1},autoplay:{type:"boolean"},oneshot:{type:"boolean"},spatialBlend:{type:"float",default:1},pitch:{type:"float",default:1},minDistance:{type:"float",default:1},maxDistance:{type:"float",default:12},rolloff:{type:"string",default:"logarithmic"}}})}(),AFRAME.registerComponent("wire",{multiple:!0,schema:{on:{type:"string"},emit:{type:"string"},gained:{type:"string"},lost:{type:"string"},gain:{type:"string"},lose:{type:"string"},targets:{type:"selectorAll"},target:{type:"selector"}},update:function(e){e.on&&this.el.removeEventListener(e.on,this.actOnTargets),e.gained&&this.el.removeEventListener("stateadded",this.actOnTargetsIfStateMatches),e.lost&&this.el.removeEventListener("stateremoved",this.actOnTargetsIfStateMatches),this.actOnTargets=function(){function e(e){this.data.emit&&e.emit(this.data.emit),this.data.gain&&e.addState(this.data.gain),this.data.lose&&e.removeState(this.data.lose)}this.data.targets&&this.data.targets.forEach(e.bind(this)),this.data.target&&e.call(this,this.data.target)}.bind(this),this.actOnTargetsIfStateMatches=function(e){var t=e.detail.state;t!==this.data.gained&&t!==this.data.lost||this.actOnTargets()}.bind(this),this.data.on&&this.el.addEventListener(this.data.on,this.actOnTargets),this.data.gained&&this.el.addEventListener("stateadded",this.actOnTargetsIfStateMatches),this.data.lost&&this.el.addEventListener("stateremoved",this.actOnTargetsIfStateMatches)},remove:function(){this.el.removeEventListener(this.data.on,this.actOnTargets),this.el.removeEventListener("stateadded",this.actOnTargetsIfStateMatches),this.el.removeEventListener("stateremoved",this.actOnTargetsIfStateMatches)}}),window.AFRAME&&(o("sync-system",k),n("altspace-cursor-collider",M),n("altspace-tracked-controls",A),n("altspace",D),n("sync-color",I),n("sync",H));var x,F,B,P,U=Object.freeze({AltspaceComponent:D,AltspaceCursorCollider:M,AltspaceTrackedControls:A,SyncSystem:k,SyncComponent:H,SyncColor:I,flatten:t}),q=window.Firebase,z=altspace&&altspace.inClient,N=s(),V=Object.freeze({connect:c}),G=new THREE.Raycaster,W=Object.freeze({init:l});window.altspace=window.altspace||{},window.altspace.utilities=window.altspace.utilities||{};var J=function(e){var t=e.auto;void 0===t&&(t=!0),this._scene=null,this._renderer=null,this._camera=null;var n=window.AFRAME&&document.querySelector("a-scene");if(n){var o=document.querySelector("a-scene");this._scene=o.object3D,this._renderer=o.renderer;var i=document.querySelector("a-camera");i&&(this._camera=i.object3D)}else window.altspace&&altspace.inClient?(this._scene=new THREE.Scene,this._renderer=altspace.getThreeJSRenderer(),this._camera=new THREE.PerspectiveCamera):this._setupWebGL();t&&!n&&this.loop()},X={scene:{},renderer:{},camera:{}};J.prototype._setupWebGL=function(){function e(){o.aspect=window.innerWidth/window.innerHeight,o.updateProjectionMatrix(),n.setSize(window.innerWidth,window.innerHeight)}var t=this._scene=new THREE.Scene,n=this._renderer=new THREE.WebGLRenderer({antialias:!0}),o=this._camera=new THREE.PerspectiveCamera;document.addEventListener("DOMContentLoaded",function(e){document.body.style.margin="0px",document.body.style.overflow="hidden",n.setClearColor("#035F72");var t=document.createElement("div");document.body.appendChild(t),t.appendChild(n.domElement)}),window.addEventListener("resize",e),e(),o.position.z=500,o.fov=45,o.near=1,o.far=2e3,t.add(o),t.add(new THREE.AmbientLight("white")),this.cursor=l(t,o)},J.prototype.loop=function(){window.requestAnimationFrame(this.loop.bind(this)),this.scene.updateAllBehaviors&&this.scene.updateAllBehaviors(),this.renderer.render(this.scene,this.camera)},X.scene.get=function(){return this._scene},X.renderer.get=function(){return this._renderer},X.camera.get=function(){return this._camera},Object.defineProperties(J.prototype,X);var Y,Z,K="",Q="",$=Object.freeze({init:y,load:g,LoadRequest:m}),ee=window.Please,te=window.Url,ne="VR CodePen",oe=window.name&&"pen-"===window.name.slice(0,4),ie=!!window.altspace.inClient,ae=!!location.href.match("codepen.io/"),se=Object.freeze({inTile:oe,inVR:ie,inCodePen:ae,ensureInVR:w,setName:_,getPenId:L,getAuthorId:C,printDebugInfo:E}),re=function(){};re.prototype.load=function(e,t,n){var o=new THREE.MTLLoader,i=t.split("/").slice(0,-1).join("/");o.setBaseUrl(i+"/"),o.setCrossOrigin(this.crossOrigin),o.load(t,function(t){var o=new THREE.OBJLoader;o.setMaterials(t),o.load(e,n)})},THREE&&!altspace.inClient&&(THREE.EventDispatcher.prototype.dispatchEvent=j,THREE.Object3D.prototype.dispatchEvent=j),THREE.Scene.prototype.updateAllBehaviors=function(){var e=performance.now(),t=this.__lastNow||e,n=e-t,o=this,i=[];this.traverse(function(e){e.__behaviorList&&i.push(e)});for(var a=0,s=i.length;a<s;a++){var r=i[a];r.updateBehaviors(n,o)}this.__lastNow=e},THREE.Object3D.prototype.addBehavior=function(){this.__behaviorList=this.__behaviorList||[],Array.prototype.push.apply(this.__behaviorList,arguments)},THREE.Object3D.prototype.addBehaviors=function(){this.__behaviorList=this.__behaviorList||[],Array.prototype.push.apply(this.__behaviorList,arguments)},THREE.Object3D.prototype.removeBehavior=function(e){if(!this.__behaviorList||0===this.__behaviorList.length)return null;var t=this.__behaviorList.indexOf(e);if(t!==-1){this.__behaviorList.splice(t,1);try{e.dispose&&e.dispose.call(e,this)}catch(t){console.group(),(console.error||console.log).call(console,t.stack||t),console.log("[Behavior]"),console.log(e),console.log("[Object3D]"),console.log(this),console.groupEnd()}}},THREE.Object3D.prototype.removeAllBehaviors=function(){var e=this;if(!this.__behaviorList||0===this.__behaviorList.length)return null;for(var t=0,n=this.__behaviorList.length;t<n;t++){var o=e.__behaviorList[t];try{o.dispose&&o.dispose.call(o,e)}catch(t){console.group(),(console.error||console.log).call(console,t.stack||t),console.log("[Behavior]"),console.log(o),console.log("[Object3D]"),console.log(e),console.groupEnd()}}this.__behaviorList.length=0},THREE.Object3D.prototype.getBehaviorByType=function(e){var t=this;if(!this.__behaviorList||0===this.__behaviorList.length)return null;for(var n=0,o=this.__behaviorList.length;n<o;n++)if(t.__behaviorList[n].type===e)return t.__behaviorList[n]},THREE.Object3D.prototype.updateBehaviors=function(e,t){var n=this;if(this.__behaviorList&&0!==this.__behaviorList.length){for(var o=[],i=this.__behaviorList.slice(),a=0,s=this.__behaviorList.length;a<s;a++){var r=n.__behaviorList[a];r.__isInitialized||o.push(r)}for(var a=0,s=o.length;a<s;a++){var r=o[a];try{r.awake&&r.awake.call(r,n,t)}catch(e){console.group(),(console.error||console.log).call(console,e.stack||e),console.log("[Behavior]"),console.log(r),console.log("[Object3D]"),console.log(n),console.groupEnd()}}for(var a=0,s=o.length;a<s;a++){var r=o[a];try{r.start&&r.start.call(r)}catch(e){console.group(),(console.error||console.log).call(console,e.stack||e),console.log("[Behavior]"),console.log(r),console.log("[Object3D]"),console.log(n),console.groupEnd()}r.__isInitialized=!0}for(var a=0,s=i.length;a<s;a++){var r=i[a];try{r.update&&r.update.call(r,e)}catch(e){console.group(),(console.error||console.log).call(console,e.stack||e),console.log("[Behavior]"),console.log(r),console.log("[Object3D]"),console.log(n),console.groupEnd()}}}};var ce=Object.freeze({OBJMTLLoader:re,cursor:W}),le=Object.freeze({shims:ce,sync:V,multiloader:$,codePen:se,Simulation:J}),de=VERSION;window.altspace&&window.altspace.requestVersion&&window.altspace.requestVersion(de),e.components=U,e.utilities=le}(this.altspace=this.altspace||{});
//# sourceMappingURL=altspace.min.js.map
