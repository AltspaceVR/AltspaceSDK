{"version":3,"file":"altspace.js.map","sources":["../../src/components/AFrameComponent.js","../../src/components/utilities.js","../../src/components/AltspaceCursorCollider.js","../../src/components/AltspaceTrackedControls.js","../../src/components/AltspaceComponent.js","../../src/components/SyncColor.js","../../src/components/SyncComponent.js","../../src/components/SyncSystem.js","../../src/components/sync-transform.js","../../src/components/sync-n-sound.js","../../src/components/native-components.js","../../src/components/wire.js","../../src/components/index.js","../../src/utilities/sync.js","../../src/utilities/shims/cursor.js","../../src/utilities/simulation.js","../../src/utilities/multiloader.js","../../src/utilities/codepen.js","../../src/utilities/shims/OBJMTLLoader.js","../../src/utilities/shims/bubbling.js","../../src/utilities/shims/behaviors.js","../../src/index.js"],"sourcesContent":["'use strict';\r\n\r\n/**\r\n* Stubs out the A-Frame \"system\" concept.\r\n* @see {@link https://aframe.io/docs/0.3.0/core/systems.html}\r\n*/\r\nclass AFrameSystem\r\n{\r\n\tget schema(){\r\n\t\treturn null;\r\n\t}\r\n\r\n\tinit(){ }\r\n\ttick(time, timeDelta){ }\r\n\tpause(){ }\r\n\tplay(){ }\r\n}\r\n\r\n/**\r\n* Stubs out the A-Frame \"component\" concept.\r\n* @extends AFrameSystem\r\n* @see {@link https://aframe.io/docs/0.3.0/core/component.html}\r\n*/\r\nclass AFrameComponent extends AFrameSystem\r\n{\r\n\tupdate(oldData){ }\r\n\tremove(){ }\r\n\tupdateSchema(data){ }\r\n}\r\n\r\nfunction flatten(obj)\r\n{\r\n\tlet ret = {};\r\n\tif(!obj.__proto__){\r\n\t\tret = Object.assign( {schema: {}, dependencies: []}, obj );\r\n\t}\r\n\telse {\r\n\t\tret = Object.assign( flatten(obj.__proto__), obj );\r\n\t}\r\n\r\n\tif(obj.schema)\r\n\t\tObject.assign(ret.schema, obj.schema);\r\n\r\n\tif(obj.dependencies)\r\n\t\tret.dependencies.push(...obj.dependencies);\r\n\r\n\treturn ret;\r\n}\r\n\r\nfunction registerComponentClass(name, cls)\r\n{\r\n\tAFRAME.registerComponent(name, flatten(new cls(true)));\r\n}\r\n\r\nfunction registerSystemClass(name, cls)\r\n{\r\n\tAFRAME.registerSystem(name, flatten(new cls(true)));\r\n}\r\n\r\nexport { AFrameComponent, AFrameSystem, registerComponentClass, registerSystemClass, flatten };\r\n","'use strict';\r\n\r\nfunction safeDeepSet(obj, keys, value)\r\n{\r\n\tif(keys.length === 0)\r\n\t\treturn value;\r\n\telse {\r\n\t\tobj[keys[0]] = safeDeepSet(obj[keys[0]] || {}, keys.slice(1), value);\r\n\t\treturn obj;\r\n\t}\r\n}\r\n\r\nexport { safeDeepSet };\r\n","/**\r\n* Enable or disable cursor collision on the object.\r\n* @mixin altspace-cursor-collider\r\n* @memberof altspace\r\n* @prop {boolean} enabled=true - The state of the cursor collider.\r\n*/\r\n\r\n'use strict';\r\n\r\nimport {AFrameComponent} from './AFrameComponent';\r\nimport {safeDeepSet} from './utilities';\r\n\r\n\r\nexport default class AltspaceCursorCollider extends AFrameComponent\r\n{\r\n\tget schema(){\r\n\t\treturn {enabled: {type: 'boolean', default: 'true'}};\r\n\t}\r\n\r\n\tinit()\r\n\t{\r\n\t\tthis.setColliderFlag(this.data.enabled);\r\n\t\tthis.el.addEventListener('model-loaded', (() => {\r\n\t\t\tthis.setColliderFlag(this.data.enabled);\r\n\t\t}).bind(this));\r\n\t}\r\n\r\n\tupdate()\r\n\t{\r\n\t\tthis.setColliderFlag(this.data.enabled);\r\n\t}\r\n\r\n\tsetColliderFlag(state)\r\n\t{\r\n\t\tlet obj = this.el.object3D;\r\n\t\tif(obj){\r\n\t\t\tconsole.log('Setting collider flag to', state);\r\n\t\t\tsafeDeepSet(obj.userData, ['altspace','collider','enabled'], state);\r\n\t\t\tobj.traverse(subobj => {\r\n\t\t\t\tif( subobj instanceof THREE.Mesh ){\r\n\t\t\t\t\tsafeDeepSet(subobj.userData, ['altspace','collider','enabled'], state);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n};\r\n","/**\r\n* Enables tracked control support for A-Frame applications that use the built-in\r\n* `tracked-controls`, `vive-controls` or `hand-controls` components.\r\n* @mixin altspace-tracked-controls\r\n* @memberof altspace\r\n*/\r\n'use strict';\r\n\r\nimport {AFrameComponent} from './AFrameComponent';\r\n\r\nexport default class AltspaceTrackedControls extends AFrameComponent\r\n{\r\n\tinit()\r\n\t{\r\n\t\tthis.gamepadIndex = null;\r\n\t\tthis.trackedControlsSystem = document.querySelector('a-scene').systems['tracked-controls'];\r\n\t\tthis.systemGamepads = 0;\r\n\t\taltspace.getGamepads();\r\n\t}\r\n\r\n\ttick()\r\n\t{\r\n\t\tif (\r\n\t\t\tthis.trackedControlsSystem &&\r\n\t\t\tthis.systemGamepads !== this.trackedControlsSystem.controllers.length &&\r\n\t\t\twindow.altspace && altspace.getGamepads && altspace.getGamepads().length\r\n\t\t) {\r\n\t\t\tvar components = this.el.components;\r\n\t\t\tif (components['paint-controls']) {\r\n\t\t\t\tthis.gamepadIndex = components['paint-controls'].data.hand === 'left' ? 2 : 1;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.gamepadIndex === null && components['hand-controls']) {\r\n\t\t\t\tthis.gamepadIndex = components['hand-controls'].data === 'left' ? 2 : 1;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.gamepadIndex === null && components['vive-controls']) {\r\n\t\t\t\tthis.gamepadIndex = components['vive-controls'].data.hand === 'left' ? 2 : 1;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.gamepadIndex === null && components['tracked-controls']) {\r\n\t\t\t\tthis.gamepadIndex = components['tracked-controls'].data.controller;\r\n\t\t\t}\r\n\r\n\t\t\tthis.el.setAttribute('tracked-controls', 'id', altspace.getGamepads()[this.gamepadIndex].id);\r\n\t\t\tthis.el.setAttribute('tracked-controls', 'controller', 0);\r\n\t\t\tthis.systemGamepads = this.trackedControlsSystem.controllers.length;\r\n\t\t}\r\n\t}\r\n}\r\n","/**\r\n* @namespace altspace\r\n*/\r\n\r\n/**\r\n* The altspace component makes A-Frame apps compatible with AltspaceVR.\r\n*\r\n* **Note**: If you use the `embedded` A-Frame component on your scene, you must include it *before* the `altspace` component, or your app will silently fail.\r\n* @mixin altspace\r\n* @memberof altspace\r\n* @property {boolean} usePixelScale=`false` - Allows you to use A-Frame units as CSS pixels.\r\n* This is the default behavior for three.js apps, but not for A-Frame apps.\r\n* @property {string} verticalAlign=`middle` - Puts the origin at the `bottom`, `middle` (default),\r\n* or `top` of the Altspace enclosure.\r\n* @property {boolean} enclosuresOnly=`true` - Prevents the scene from being created if\r\n* enclosure is flat.\r\n* @property {boolean} fullspace=`false` - Puts the app into fullspace mode.\r\n*\r\n* @example\r\n* <head>\r\n*   <title>My A-Frame Scene</title>\r\n*   <script src=\"https://aframe.io/releases/0.3.0/aframe.min.js\"></script>\r\n*   <script src=\"https://cdn.rawgit.com/AltspaceVR/aframe-altspace-component/vAFRAME_ALTSPACE_VERSION/dist/aframe-altspace-component.min.js\"></script>\r\n* </head>\r\n* <body>\r\n*   <a-scene altspace>\r\n*     <a-entity geometry=\"primitive: box\" material=\"color: #C03546\"></a-entity>\r\n*   </a-scene>\r\n* </body>\r\n*/\r\n'use strict';\r\n\r\nimport {AFrameComponent} from './AFrameComponent';\r\n\r\nexport default class AltspaceComponent extends AFrameComponent\r\n{\r\n\tget schema(){\r\n\t\treturn {\r\n\t\t\tusePixelScale: { type: 'boolean', default: 'false'},\r\n\t\t\tverticalAlign: { type: 'string',  default: 'middle'},\r\n\t\t\tenclosuresOnly:{ type: 'boolean', default: 'true'},\r\n\t\t\tfullspace:     { type: 'boolean', default: 'false'}\r\n\t\t}\r\n\t}\r\n\r\n\tinit()\r\n\t{\r\n\t\tthis.version = 'AFRAME_ALTSPACE_VERSION';\r\n\t\tif(!this.el.object3D instanceof THREE.Scene){\r\n\t\t\tconsole.warn('aframe-altspace-component can only be attached to a-scene');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (window.altspace && window.altspace.inClient) {\r\n\t\t\tthis.el.setAttribute('vr-mode-ui', {enabled: false});\r\n\t\t\tthis.initRenderer();\r\n\t\t\tthis.initCursorEvents();\r\n\t\t\tthis.initCollisionEvents();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tconsole.warn('aframe-altspace-component only works inside of AltspaceVR');\r\n\t\t}\r\n\t}\r\n\r\n\ttick(t, dt)\r\n\t{\r\n\t\tif(this.el.object3D.updateAllBehaviors)\r\n\t\t\tthis.el.object3D.updateAllBehaviors();\r\n\t}\r\n\r\n\t/*\r\n\t* Swap in Altspace renderer when running in AltspaceVR.\r\n\t*/\r\n\tinitRenderer()\r\n\t{\r\n\t\tlet scene = this.el.object3D;\r\n\t\taltspace.getEnclosure().then((e =>\r\n\t\t{\r\n\t\t\tif(this.data.fullspace){\r\n\t\t\t\te.requestFullspace();\r\n\t\t\t\te.addEventListener('fullspacechange', () => {\r\n\t\t\t\t\tscene.scale.setScalar(e.pixelsPerMeter);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif (!this.data.usePixelScale || this.data.fullspace){\r\n\t\t\t\tscene.scale.setScalar(e.pixelsPerMeter);\r\n\t\t\t}\r\n\r\n\t\t\tswitch (this.data.verticalAlign) {\r\n\t\t\t\tcase 'bottom':\r\n\t\t\t\t\tscene.position.y -= e.innerHeight / 2;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'top':\r\n\t\t\t\t\tscene.position.y += e.innerHeight / 2;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'middle':\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tconsole.warn('Unexpected value for verticalAlign: ', this.data.verticalAlign);\r\n\t\t\t}\r\n\r\n\t\t\tif(this.data.enclosuresOnly && e.innerDepth === 1){\r\n\t\t\t\tthis.el.renderer.render(new THREE.Scene());\r\n\t\t\t\tthis.el.renderer = this.el.effect = oldRenderer;\r\n\r\n\t\t\t}\r\n\t\t}).bind(this));\r\n\r\n\t\tlet oldRenderer = this.el.renderer;\r\n\t\tlet renderer = this.el.renderer = this.el.effect = altspace.getThreeJSRenderer({\r\n\t\t\taframeComponentVersion: this.version\r\n\t\t});\r\n\r\n\t\tlet noop = function() {};\r\n\t\trenderer.setSize = noop;\r\n\t\trenderer.setPixelRatio = noop;\r\n\t\trenderer.setClearColor = noop;\r\n\t\trenderer.clear = noop;\r\n\t\trenderer.enableScissorTest = noop;\r\n\t\trenderer.setScissor = noop;\r\n\t\trenderer.setViewport = noop;\r\n\t\trenderer.getPixelRatio = noop;\r\n\t\trenderer.getMaxAnisotropy = noop;\r\n\t\trenderer.setFaceCulling = noop;\r\n\t\trenderer.context = {canvas: {}};\r\n\t\trenderer.shadowMap = {};\r\n\t}\r\n\r\n\t/*\r\n\t* Emulate A-Frame cursor events when running in AltspaceVR.\r\n\t*/\r\n\tinitCursorEvents()\r\n\t{\r\n\r\n\t\tlet scene = this.el.object3D;\r\n\t\tlet cursorEl = document.querySelector('a-cursor') || document.querySelector('a-entity[cursor]');\r\n\t\tif (cursorEl) {\r\n\t\t\t// Hide A-Frame cursor mesh.\r\n\t\t\tcursorEl.setAttribute('material', 'transparent', true);\r\n\t\t\tcursorEl.setAttribute('material', 'opacity', 0.0);\r\n\t\t}\r\n\r\n\t\tfunction emit(eventName, event)\r\n\t\t{\r\n\t\t\t// Fire events on intersected object and A-Frame cursor.\r\n\t\t\tlet targetEl = event.target.el;\r\n\t\t\tif (cursorEl){\r\n\t\t\t\tcursorEl.emit(eventName, { target: targetEl, ray: event.ray, point: event.point });\r\n\t\t\t}\r\n\r\n\t\t\tif (targetEl){\r\n\t\t\t\ttargetEl.emit(eventName, { target: targetEl, ray: event.ray, point: event.point });\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet cursordownObj = null;\r\n\t\tscene.addEventListener('cursordown', event => {\r\n\t\t\tcursordownObj = event.target;\r\n\t\t\temit('mousedown', event);\r\n\t\t});\r\n\r\n\t\tscene.addEventListener('cursorup', event => {\r\n\t\t\temit('mouseup', event);\r\n\t\t\tif (event.target.uuid === cursordownObj.uuid) {\r\n\t\t\t\temit('click', event);\r\n\t\t\t}\r\n\t\t\tcursordownObj = null;\r\n\t\t});\r\n\r\n\t\tscene.addEventListener('cursorenter', event => {\r\n\t\t\tif (!event.target.el){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tevent.target.el.addState('hovered');\r\n\t\t\tif (cursorEl){\r\n\t\t\t\tcursorEl.addState('hovering');\r\n\t\t\t}\r\n\t\t\temit('mouseenter', event);\r\n\t\t});\r\n\r\n\t\tscene.addEventListener('cursorleave', event => {\r\n\t\t\tif (!event.target.el){\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tevent.target.el.removeState('hovered');\r\n\t\t\tif (cursorEl){\r\n\t\t\t\tcursorEl.removeState('hovering');\r\n\t\t\t}\r\n\t\t\temit('mouseleave', event);\r\n\t\t});\r\n    }\r\n\r\n\tinitCollisionEvents()\r\n\t{\r\n\t\tlet scene = this.el.object3D;\r\n\r\n\t\tfunction emit(eventName, event)\r\n\t\t{\r\n\t\t\tlet targetEl = event.target.el;\r\n\t\t\tif (!targetEl)\r\n\t\t\t\treturn;\r\n\r\n\t\t\t//remap target and other from object3Ds to aframe element\r\n\t\t\tevent.target = targetEl;\r\n\t\t\tif (event.other && event.other.el) {\r\n\t\t\t\tevent.other = event.other.el;\r\n\t\t\t}\r\n\t\t\ttargetEl.emit(eventName, event);\r\n\t\t};\r\n\r\n\t\tscene.addEventListener('collisionenter', event => {\r\n\t\t\temit('collisionenter', event);\r\n\t\t});\r\n\r\n\t\tscene.addEventListener('collisionexit', event => {\r\n\t\t\temit('collisionexit', event);\r\n\t\t});\r\n\r\n\t\tscene.addEventListener('triggerenter', event => {\r\n\t\t\temit('triggerenter', event);\r\n\t\t});\r\n\r\n\t\tscene.addEventListener('triggerexit', event => {\r\n\t\t\temit('triggerexit', event);\r\n\t\t});\r\n\r\n    }\r\n}\r\n","/**\r\n* Sync the color property of the object between clients.\r\n* Requires both a {@link sync.sync-system} component on the `a-scene`, and a\r\n* {@link sync.sync} component on the target entity.\r\n* @mixin sync-color\r\n* @memberof sync\r\n*/\r\n'use strict';\r\n\r\nimport {AFrameComponent} from './AFrameComponent';\r\n\r\nexport default class SyncColor extends AFrameComponent\r\n{\r\n\tget dependencies(){\r\n\t\treturn ['sync'];\r\n\t}\r\n\r\n\tinit()\r\n\t{\r\n\t\tthis.sync = this.el.components.sync;\r\n\r\n\t\t// wait for firebase connection to start sync routine\r\n\t\tif(this.sync.isConnected)\r\n\t\t\tstart();\r\n\t\telse\r\n\t\t\tthis.el.addEventListener('connected', this.start.bind(this));\r\n\t}\r\n\r\n\tstart()\r\n\t{\r\n\t\tlet colorRef = this.sync.dataRef.child('material/color');\r\n\t\tlet refChangedLocked = false;\r\n\t\tlet firstValue = true;\r\n\r\n\t\tcomponent.el.addEventListener('componentchanged', event =>\r\n\t\t{\r\n\t\t\tlet name = event.detail.name;\r\n\t\t\tlet oldData = event.detail.oldData;\r\n\t\t\tlet newData = event.detail.newData;\r\n\r\n\t\t\tif (name === 'material' && !refChangedLocked && oldData.color !== newData.color && sync.isMine)\r\n\t\t\t{\r\n\t\t\t\t//For some reason A-Frame has a misconfigured material reference if we do this too early\r\n\t\t\t\tsetTimeout(() => colorRef.set(newData.color), 0);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tcolorRef.on('value', snapshot => {\r\n\t\t\tif(!sync.isMine || firstValue)\r\n\t\t\t{\r\n\t\t\t\tlet color = snapshot.val();\r\n\r\n\t\t\t\trefChangedLocked = true;\r\n\t\t\t\tcomponent.el.setAttribute('material', 'color', color);\r\n\t\t\t\trefChangedLocked = false;\r\n\r\n\t\t\t\tfirstValue = false;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n","/**\r\n* Enables the synchronization of properties of entities. All property sync components\r\n* require both a {@link sync.sync-system} on `a-scene`, and a {@link sync.sync}\r\n* on the entity to be synced.\r\n* @name sync\r\n* @namespace sync\r\n* @example\r\n* <a-scene sync-system='app: example sync; author: altspacevr'>\r\n*   <a-entity sync='ownOn: cursordown' sync-color></a-entity>\r\n* </a-scene>\r\n*/\r\n\r\n/**\r\n* Enables the synchronization of properties of the entity. Must be used in\r\n* conjuction with the {@link sync.sync-system} component and a component for a\r\n* specific property (e.g. {@link sync.sync-transform}).\r\n* @memberof sync\r\n* @mixin sync\r\n* @prop {string} ownOn - The name of the event, or a list of events, that\r\n* will cause the local client to take ownership of this object. This field\r\n* cannot be updated after initialization.\r\n*/\r\n\r\nimport {AFrameComponent} from './AFrameComponent';\r\n\r\nexport default class SyncComponent extends AFrameComponent\r\n{\r\n\tconstructor(isComponent = false)\r\n\t{\r\n\t\tthis._isComponent = isComponent;\r\n\r\n\t\tthis.scene = undefined;\r\n\t\tthis.syncSys = undefined;\r\n\t\tthis.ref = undefined;\r\n\t\tthis.key = undefined;\r\n\t\tthis.dataRef = undefined;\r\n\t\tthis.ownerRef = undefined;\r\n\t\tthis.ownerId = undefined;\r\n\r\n\t\tthis.isConnected = false;\r\n\r\n\t\t/**\r\n\t\t* Indicates whether the sync ownership is yours.\r\n\t\t* @member sync.sync#isMine\r\n\t\t* @readonly\r\n\t\t*/\r\n\t\tthis.isMine = false;\r\n\t}\r\n\r\n\tget schema(){\r\n\t\treturn {\r\n\t\t\tmode: { default: 'link' },\r\n\t\t\townOn: { type: 'string' } //cannot be changed after creation\r\n\t\t};\r\n\t}\r\n\r\n\tinit()\r\n\t{\r\n\t\tthis.scene = this.el.sceneEl;\r\n\t\tthis.syncSys = this.scene.systems['sync-system'];\r\n\r\n\t\tif(this.syncSys.isConnected)\r\n\t\t\tstart();\r\n\t\telse\r\n\t\t\tthis.scene.addEventListener('connected', this.start.bind(this));\r\n\r\n\t\tif(this.data.ownOn)\r\n\t\t{\r\n\t\t\tlet ownershipEvents = this.data.ownOn.split(/[ ,]+/);\r\n\t\t\townershipEvents.forEach((e => {\r\n\t\t\t\tthis.el.addEventListener(e, (() => {\r\n\t\t\t\t\tif(this.isConnected){\r\n\t\t\t\t\t\tthis.takeOwnership();\r\n\t\t\t\t\t}\r\n\t\t\t\t}).bind(this));\r\n\t\t\t}).bind(this));\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t* Tell sync to start pushing local property values instead of updating\r\n\t* local from remote values.\r\n\t* @method sync.sync#takeOwnership\r\n\t*/\r\n\ttakeOwnership()\r\n\t{\r\n\t\tthis.ownerRef.set(this.syncSys.clientId);\r\n\r\n\t\t//clear our ownership if we disconnect\r\n\t\t//this is needed if we are the last user in the room, but we expect people to join later\r\n\t\tthis.ownerRef.onDisconnect().set(null);\r\n\t}\r\n\r\n\tstart()\r\n\t{\r\n\t\t//Make sure someone always owns an object. If the owner leaves and we are the master client, we will take it.\r\n\t\t//This ensures, for example, that synced animations keep playing\r\n\t\tthis.scene.addEventListener('clientleft', (event => {\r\n\t\t\tlet shouldTakeOwnership = (!ownerId || ownerId === event.detail.id) && this.syncSys.isMasterClient;\r\n\t\t\tif(shouldTakeOwnership)\r\n\t\t\t\tthis.takeOwnership();\r\n\t\t}).bind(this));\r\n\r\n\t\tif (this.data.mode === 'link') {\r\n\t\t\tlet id = this.el.id;\r\n\t\t\tif (!id) {\r\n\t\t\t\tconsole.error('Entities cannot be synced using link mode without an id.');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconsole.log('syncSys: ' + this.syncSys);\r\n\t\t\tconsole.log('syncSys.sceneRef: ' + this.syncSys.sceneRef);\r\n\r\n\t\t\tthis.link(this.syncSys.sceneRef.child(id));\r\n\t\t\tthis.setupReceive();\r\n\r\n\t\t} else {\r\n\t\t\tconsole.error('Unsupported sync mode: ' + this.data.mode);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.isConnected = true;\r\n\t\tthis.el.emit('connected', null, false);\r\n\t}\r\n\r\n\tlink(entityRef)\r\n\t{\r\n\t\tthis.ref = entityRef;\r\n\t\tthis.key = this.ref.key();\r\n\t\tthis.dataRef = this.ref.child('data');\r\n\t\tthis.ownerRef = this.ref.child('owner');\r\n\t}\r\n\r\n\tsetupReceive()\r\n\t{\r\n\t\t//if nobody has owned the object yet, we will.\r\n\t\tthis.ownerRef.transaction((owner => {\r\n\t\t\tif (owner) return undefined;\r\n\t\t\tthis.ownerRef.onDisconnect().set(null);\r\n\t\t\treturn this.syncSys.clientId;\r\n\t\t}).bind(this));\r\n\r\n\t\tthis.ownerRef.on('value', (snapshot =>\r\n\t\t{\r\n\t\t\tlet newOwnerId = snapshot.val();\r\n\t\t\tlet gained = newOwnerId === this.syncSys.clientId && !this.isMine;\r\n\t\t\tif (gained)\r\n\t\t\t\tthis.el.emit('ownershipgained', null, false);\r\n\r\n\t\t\t//note this also fires when we start up without ownership\r\n\t\t\tlet lost = newOwnerId !== this.syncSys.clientId && this.isMine;\r\n\t\t\tif (lost){\r\n\t\t\t\tthis.el.emit('ownershiplost', null, false);\r\n\r\n\t\t\t\t//we no longer have to clear our ownership when we disconnect\r\n\t\t\t\tthis.ownerRef.onDisconnect().cancel();\r\n\t\t\t}\r\n\r\n\t\t\tthis.ownerId = newOwnerId;\r\n\r\n\t\t\tthis.isMine = newOwnerId === this.syncSys.clientId;\r\n\t\t}).bind(this));\r\n\t}\r\n}\r\n","'use strict';\r\n\r\nimport {AFrameSystem} from './AFrameComponent';\r\n\r\n/**\r\n* Connect to a remote Firebase server, and facilitate synchronization. These\r\n* options correspond exactly with the configuration options for\r\n* [altspace.utilities.sync.connect]{@link http://altspacevr.github.io/AltspaceSDK/doc/module-altspace_utilities_sync.html#.connect}.\r\n* This component must be present on `a-scene` for any other sync components to work.\r\n* @extends AFrameSystem\r\n* @memberof module:altspace/components\r\n*/\r\nclass SyncSystem extends AFrameSystem\r\n{\r\n\t/**\r\n\t* @prop {string} author - A unique identifier for you or your organization.\r\n\t* @prop {string} app - The name of the app.\r\n\t* @prop {string} refUrl - Override the base reference. Set this to use your own Firebase.\r\n\t* @prop {string} instance - Override the instance ID. Can also be overridden with\r\n\t* a URL parameter.\r\n\t*/\r\n\tget schema(){\r\n\t\treturn {\r\n\t\t\tauthor: { type: 'string', default: null },\r\n\t\t\tapp: { type: 'string', default: null },\r\n\t\t\tinstance: { type: 'string', default: null },\r\n\t\t\trefUrl: { type: 'string', default: null }\r\n\t\t};\r\n\t}\r\n\r\n\tinit()\r\n\t{\r\n\t\tif(!this.data || !this.data.app){\r\n\t\t\tconsole.warn('The sync-system must be present on the scene and configured with required data.');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconsole.log(this.data);\r\n\r\n\t\tthis.isConnected = false;\r\n\t\taltspace.utilities.sync.connect({\r\n\t\t\tauthorId: this.data.author,\r\n\t\t\tappId: this.data.app,\r\n\t\t\tinstanceId: this.data.instance,\r\n\t\t\tbaseRefUrl: this.data.refUrl\r\n\t\t}).then(this.connected.bind(this));\r\n\t}\r\n\r\n\tconnected(connection)\r\n\t{\r\n\t\tthis.connection = connection;\r\n\r\n\t\tthis.sceneRef = this.connection.instance.child('scene');\r\n\t\tthis.clientsRef = this.connection.instance.child('clients');\r\n\r\n\t\t// temporary way of having unique identifiers for each client\r\n\t\tthis.clientId = this.sceneEl.object3D.uuid;\r\n\t\tthis.masterClientId = null;\r\n\r\n\t\tlet self = this;\r\n\r\n\t\t// local client connected\r\n\t\tthis.clientsRef.on(\"value\", snapshot => {\r\n\t\t\tlet clientIds = snapshot.val();\r\n\t\t\tlet masterClientKey = Object.keys(clientIds)[0];\r\n\t\t\tself.masterClientId = clientIds[masterClientKey];\r\n\t\t});\r\n\r\n\t\t// remote client connected\r\n\t\tthis.clientsRef.on('child_added', childSnapshot => {\r\n\t\t\tlet joinedClientId = childSnapshot.val();\r\n\t\t\t//let the master client flag get set first\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tself.sceneEl.emit('clientjoined', {id: joinedClientId}, false);\r\n\t\t\t}, 0);\r\n\t\t});\r\n\r\n\t\t// remote client disconnected\r\n\t\tthis.clientsRef.on('child_removed', childSnapshot => {\r\n\t\t\tlet leftClientId = childSnapshot.val();\r\n\t\t\t//let the master client flag get set first\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tself.sceneEl.emit('clientleft', {id: leftClientId}, false);\r\n\t\t\t}, 0);\r\n\t\t});\r\n\r\n\t\t// add our client ID to the list of connected clients,\r\n\t\t// but have it be automatically removed by firebase if we disconnect for any reason\r\n\t\tthis.clientsRef.push(this.clientId).onDisconnect().remove();\r\n\r\n\t\tthis.connection.instance.child('initialized').once('value', snapshot => {\r\n\t\t\tlet shouldInitialize = !snapshot.val();\r\n\t\t\tsnapshot.ref().set(true);\r\n\r\n\t\t\tself.sceneEl.emit('connected', { shouldInitialize: shouldInitialize }, false);\r\n\t\t\tself.isConnected = true;\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t* Returns true if the local client is the master client.\r\n\t*/\r\n\tisMasterClient()\r\n\t{\r\n\t\treturn this.masterClientId === this.clientId;\r\n\t}\r\n}\r\n\r\nexport default SyncSystem;\r\n","//TODO: We need to figure out a way to recieve our first update without caring about ownership.\r\n// firstValue is probably not the right way to go, probably something about having sent yet. Need to change for both\r\n\r\n/**\r\n* Synchronize the position, rotation, and scale of this object with all clients.\r\n* Requires both a {@link sync.sync-system} component on the `a-scene`, and a\r\n* {@link sync.sync} component on the target entity.\r\n* @mixin sync-transform\r\n* @memberof sync\r\n*/\r\nAFRAME.registerComponent('sync-transform',\r\n{\r\n\tdependencies: ['sync'],\r\n\tschema: {\r\n\t},\r\n\tinit: function () {\r\n\t\tvar component = this;\r\n\t\tvar sync = component.el.components.sync;\r\n\t\tif(sync.isConnected) start(); else component.el.addEventListener('connected', start);\r\n\r\n\t\tfunction start(){\r\n\r\n\t\t\tvar positionRef = sync.dataRef.child('position');\r\n\t\t\tvar rotationRef = sync.dataRef.child('rotation');\r\n\t\t\tvar scaleRef = sync.dataRef.child('scale');\r\n\r\n\t\t\tcomponent.updateRate = 100;\r\n\r\n\t\t\tvar stoppedAnimations = [];\r\n\t\t\t//pause all animations on ownership loss\r\n\t\t\tcomponent.el.addEventListener('ownershiplost', function() {\r\n\t\t\t\tvar children = component.el.children;\r\n\t\t\t\tfor (var i = 0; i < children.length; i++) {\r\n\t\t\t\t\tvar tagName = children[i].tagName.toLowerCase();\r\n\t\t\t\t\tif (tagName === \"a-animation\") {\r\n\t\t\t\t\t\tstoppedAnimations.push(children[i]);\r\n\t\t\t\t\t\tchildren[i].stop();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tcomponent.el.addEventListener('ownershipgained', function () {\r\n\t\t\t\tfor (var i = 0; i < stoppedAnimations.length; i++) {\r\n\t\t\t\t\tvar animation = stoppedAnimations[i];\r\n\t\t\t\t\tanimation.start();\r\n\t\t\t\t}\r\n\t\t\t\tstoppedAnimations = [];\r\n\t\t\t});\r\n\r\n\t\t\tfunction onTransform(snapshot, componentName) {\r\n\t\t\t\tif (sync.isMine) return;\r\n\r\n\t\t\t\tvar value = snapshot.val();\r\n\t\t\t\tif (!value) return;\r\n\r\n\t\t\t\tcomponent.el.setAttribute(componentName, value);\r\n\t\t\t}\r\n\r\n\t\t\tpositionRef.on('value', function (snapshot) {\r\n\t\t\t\tonTransform(snapshot, 'position');\r\n\t\t\t});\r\n\r\n\t\t\trotationRef.on('value', function (snapshot) {\r\n\t\t\t\tonTransform(snapshot, 'rotation');\r\n\t\t\t});\r\n\r\n\t\t\tscaleRef.on('value', function (snapshot) {\r\n\t\t\t\tonTransform(snapshot, 'scale');\r\n\t\t\t});\r\n\r\n\t\t\tvar sendPosition = throttle(function(value){\r\n\t\t\t\tpositionRef.set(value);\r\n\t\t\t}, component.updateRate);\r\n\r\n\t\t\tvar sendRotation = throttle(function(value){\r\n\t\t\t\trotationRef.set(value);\r\n\t\t\t}, component.updateRate);\r\n\r\n\t\t\tvar sendScale = throttle(function(value){\r\n\t\t\t\tscaleRef.set(value);\r\n\t\t\t}, component.updateRate);\r\n\r\n\t\t\tfunction onComponentChanged(event){\r\n\t\t\t\tif (!sync.isMine) return;\r\n\r\n\t\t\t\tvar name = event.detail.name;\r\n\t\t\t\tvar newData = event.detail.newData;\r\n\r\n\t\t\t\tif (name === 'position') {\r\n\t\t\t\t\tsendPosition(newData);\r\n\t\t\t\t} else if (name === 'rotation') {\r\n\t\t\t\t\tsendRotation(newData);\r\n\t\t\t\t} else if (name === 'scale') {\r\n\t\t\t\t\tsendScale(newData);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//from underscore.js\r\n\t\t\tfunction throttle(func, wait, options) {\r\n\t\t\t\tvar timeout, context, args, result;\r\n\t\t\t\tvar previous = 0;\r\n\t\t\t\tif (!options) options = {};\r\n\r\n\t\t\t\tvar later = function() {\r\n\t\t\t\t  previous = options.leading === false ? 0 : Date.now();\r\n\t\t\t\t  timeout = null;\r\n\t\t\t\t  result = func.apply(context, args);\r\n\t\t\t\t  if (!timeout) context = args = null;\r\n\t\t\t\t};\r\n\r\n\t\t\t\tvar throttled = function() {\r\n\t\t\t\t  var now = Date.now();\r\n\t\t\t\t  if (!previous && options.leading === false) previous = now;\r\n\t\t\t\t  var remaining = wait - (now - previous);\r\n\t\t\t\t  context = this;\r\n\t\t\t\t  args = arguments;\r\n\t\t\t\t  if (remaining <= 0 || remaining > wait) {\r\n\t\t\t\t\tif (timeout) {\r\n\t\t\t\t\t  clearTimeout(timeout);\r\n\t\t\t\t\t  timeout = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tprevious = now;\r\n\t\t\t\t\tresult = func.apply(context, args);\r\n\t\t\t\t\tif (!timeout) context = args = null;\r\n\t\t\t\t  } else if (!timeout && options.trailing !== false) {\r\n\t\t\t\t\ttimeout = setTimeout(later, remaining);\r\n\t\t\t\t  }\r\n\t\t\t\t  return result;\r\n\t\t\t\t};\r\n\r\n\t\t\t\tthrottled.cancel = function() {\r\n\t\t\t\t  clearTimeout(timeout);\r\n\t\t\t\t  previous = 0;\r\n\t\t\t\t  timeout = context = args = null;\r\n\t\t\t\t};\r\n\r\n\t\t\t\treturn throttled;\r\n\t\t\t  };\r\n\r\n\r\n\t\t\tcomponent.el.addEventListener('componentchanged', onComponentChanged);\r\n\t\t}\r\n\t}\r\n});\r\n\r\nexport default null;\r\n","/**\r\n* Synchronize the playback state of an {@link n.n-sound} component between clients.\r\n* Requires both a {@link sync.sync-system} component on the `a-scene`, and a\r\n* {@link sync.sync} component on the target entity.\r\n* @mixin sync-n-sound\r\n* @memberof sync\r\n*/\r\n'use strict';\r\n\r\nimport {AFrameComponent} from './AFrameComponent';\r\n\r\nexport default class SyncNSound extends AFrameComponent\r\n{\r\n\tget dependencies(){\r\n\t\treturn ['sync'];\r\n\t}\r\n}\r\n\r\nAFRAME.registerComponent('sync-n-sound',\r\n{\r\n\tdependencies: ['sync'],\r\n\tschema: { },\r\n\tinit: function () {\r\n\t\tvar component = this;\r\n\t\tvar sync = component.el.components.sync;\r\n\t\tvar scene = document.querySelector('a-scene');\r\n\t\tvar syncSys = scene.systems['sync-system'];\r\n\t\tif(sync.isConnected) start(); else component.el.addEventListener('connected', start);\r\n\r\n\t\tfunction start(){\r\n\t\t\tcomponent.soundStateRef = sync.dataRef.child('sound/state');\r\n\t\t\tcomponent.soundEventRef = sync.dataRef.child('sound/event');\r\n\r\n\t\t\tfunction sendEvent(event) {\r\n\t\t\t\tif (!sync.isMine) return;\r\n\t\t\t\tvar event = {\r\n\t\t\t\t\ttype: event.type,\r\n\t\t\t\t\tsender: syncSys.clientId,\r\n\t\t\t\t\tel: component.el.id,\r\n\t\t\t\t\ttime: Date.now()\r\n\t\t\t\t};\r\n\t\t\t\tcomponent.soundEventRef.set(event);\r\n\t\t\t}\r\n\r\n\t\t\tcomponent.el.addEventListener('sound-played', sendEvent);\r\n\t\t\tcomponent.el.addEventListener('sound-paused', sendEvent);\r\n\r\n\t\t\tcomponent.soundEventRef.on('value', function (snapshot) {\r\n\t\t\t\tif (sync.isMine) return;\r\n\t\t\t\tvar event = snapshot.val();\r\n\t\t\t\tif (!event) return;\r\n\t\t\t\tif (event.el === component.el.id) {\r\n\t\t\t\t\tvar sound = component.el.components['n-sound'];\r\n\t\t\t\t\tif (event.type === 'sound-played') {\r\n\t\t\t\t\t\tsound.playSound();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tsound.pauseSound();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tcomponent.el.addEventListener('componentchanged', function (event) {\r\n\t\t\t\tif (!sync.isMine) return;\r\n\t\t\t\tvar name = event.detail.name;\r\n\t\t\t\tif (name !== 'n-sound') return;\r\n\t\t\t\tcomponent.soundStateRef.set(event.detail.newData);\r\n\t\t\t});\r\n\r\n\t\t\tcomponent.soundStateRef.on('value', function (snapshot) {\r\n\t\t\t\tif (sync.isMine) return;\r\n\t\t\t\tvar state = snapshot.val();\r\n\t\t\t\tif (!state) return;\r\n\t\t\t\tcomponent.el.setAttribute('n-sound', state);\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\tremove: function () {\r\n\t\tthis.soundStateRef.off('value');\r\n\t\tthis.soundEventRef.off('value');\r\n\t}\r\n});\r\n","\r\n/**\r\n* This set of components map to various objects and effects that are provided\r\n* natively by AltspaceVR. Your management of these objects may be limited to\r\n* some degree, but they will tend to be more performant than SDK equivalents,\r\n* or may provide some functionality not otherwise available to the SDK.\r\n* @namespace native\r\n*/\r\n(function () {\r\n\tif (!window.altspace || !altspace.inClient) {\r\n\t\tvar noop = function () {};\r\n\t\twindow.altspace = {\r\n\t\t\taddNativeComponent: noop,\r\n\t\t\tupdateNativeComponent: noop,\r\n\t\t\tremoveNativeComponent: noop\r\n\t\t};\r\n\t}\r\n\r\n\tvar placeholderGeometry = new THREE.BoxGeometry(0.001, 0.001, 0.001);\r\n\tvar placeholderMaterial = new THREE.MeshBasicMaterial({ color: 0x000000 });\r\n\tplaceholderMaterial.visible = false;\r\n\tvar PlaceholderMesh = function () {\r\n\t\tTHREE.Mesh.call( this, placeholderGeometry, placeholderMaterial );\r\n\t};\r\n\tPlaceholderMesh.prototype = Object.create( THREE.Mesh.prototype );\r\n\tPlaceholderMesh.prototype.constructor = THREE.PlaceholderMesh;\r\n\r\n\tfunction meshInit(mesh) {\r\n\t\t//If you attach native components to an entity, it will not use a default collider\r\n\t\tmesh.userData.altspace = mesh.userData.altspace || {};\r\n\t\tmesh.userData.altspace.collider = mesh.userData.altspace.collider || {};\r\n\t\tmesh.userData.altspace.collider.enabled = false;\r\n\r\n\t\taltspace.addNativeComponent(mesh, this.name);\r\n\t}\r\n\r\n\tfunction nativeComponentInit() {\r\n\t\tvar mesh = this.el.getOrCreateObject3D('mesh', PlaceholderMesh);\r\n\r\n\t\tmeshInit.call(this, mesh);\r\n\r\n\t\t//to pass defaults\r\n\t\tthis.update(this.data);\r\n\t}\r\n\tfunction nativeComponentRemove() {\r\n\t\tvar mesh = this.el.getObject3D('mesh');\r\n\t\taltspace.removeNativeComponent(mesh, this.name);\r\n\t}\r\n\tfunction nativeComponentUpdate(oldData) {\r\n\t\taltspace.updateNativeComponent(this.el.object3DMap.mesh, this.name, this.data);\r\n\t}\r\n\r\n\tfunction callComponent(functionName, functionArguments) {\r\n\t\taltspace.callNativeComponent(this.el.object3DMap.mesh, this.name, functionName, functionArguments)\r\n\t}\r\n\r\n\t/**\r\n\t* Attach a given native object to this entity.\r\n\t* @mixin n-object\r\n\t* @memberof native\r\n\t* @prop {string} res - The identifier for the resource you want. This component\r\n\t* can accept all resources except for `interactables`.\r\n\t* @example <a-entity n-object='res:architecture/wall-4w-4h'></a-entity>\r\n\t*/\r\n\tAFRAME.registerComponent('n-object', {\r\n\t\tschema: {\r\n\t\t\tres: {type: 'string'}\r\n\t\t},\r\n\t\tinit: nativeComponentInit,\r\n\t\tupdate: nativeComponentUpdate,\r\n\t\tremove: nativeComponentRemove\r\n\t});\r\n\r\n\t/**\r\n\t* Create an object that spawns additional copies of itself when grabbed by a user (the copies are not spawners themselves).\r\n\t* These copies will be physically interactive and automatically synchronized\r\n\t* between users.\r\n\t* @mixin n-spawner\r\n\t* @memberof native\r\n\t* @prop {string} res - The identifier for the resource you want. This component\r\n\t* can only accept resources of type `interactables`.\r\n\t* @example <a-entity n-spawner='res: interactables/basketball'></a-entity>\r\n\t*/\r\n\tAFRAME.registerComponent('n-spawner', {\r\n\t\tschema: {\r\n\t\t\tres: {type: 'string'}\r\n\t\t},\r\n\t\tinit: nativeComponentInit,\r\n\t\tupdate: nativeComponentUpdate,\r\n\t\tremove: nativeComponentRemove\r\n\t});\r\n\r\n\t/**\r\n\t* Creates dynamic 2D text on the entity. The text will wrap automatically based on the width and height provided.\r\n\t* This text will be clearer than texture-based text and more performant than geometry-based test.\r\n\t* @mixin n-text\r\n\t* @memberof native\r\n\t* @prop {string} text - The text to be drawn.\r\n\t* @prop {number} fontSize=10 - The height of the letters. 10pt ~= 1m\r\n\t* @prop {number} width=10 - The width of the text area in meters. If the\r\n\t* text is wider than this value, the overflow will be wrapped to the next line.\r\n\t* @prop {number} height=1 - The height of the text area in meters. If the\r\n\t* text is taller than this value, the overflow will be cut off.\r\n\t* @prop {string} horizontalAlign=middle - The horizontal anchor point for\r\n\t* the text. Can be `left`, `middle`, or `right`.\r\n\t* @prop {string} verticalAlign=middle - The vertical anchor point for the\r\n\t* text. Can be `top`, `middle`, or `bottom`.\r\n\t*/\r\n\tAFRAME.registerComponent('n-text', {\r\n\t\tinit: nativeComponentInit,\r\n\t\tupdate: nativeComponentUpdate,\r\n\t\tremove: nativeComponentRemove,\r\n\t\tschema: {\r\n\t\t\ttext: { default: '', type: 'string' },\r\n\t\t\t/*color: { default: 'white',\r\n\t\t\t\tparse: function(value) {\r\n\t\t\t\t\treturn parseFloat(value, 10);\r\n\t\t\t\t},\r\n\t\t\t\tstringify: function(value) {\r\n\t\t\t\t\treturn value.toString();\r\n\t\t\t\t}},*/\r\n\t\t\tfontSize: { default: '10', type: 'int' },//roughly a meter tall\r\n\t\t\twidth: { default: '10', type: 'number' },//in meters\r\n\t\t\theight: { default: '1', type: 'number' },//in meters\r\n\t\t\thorizontalAlign: { default: 'middle'},\r\n\t\t\tverticalAlign: { default: 'middle'}\r\n\t\t}\r\n\t});\r\n\r\n\t//object: collides against: objects / enviroment / cursor\r\n\t//environment: can be teleported onto, and collides against: objects / environment / cursor\r\n\t//hologram: collides against: cursor / holograms\r\n\r\n\t/**\r\n\t* Abstract base class for {@link n.n-sphere-collider}, {@link n.n-box-collider},\r\n\t* {@link n.n-capsule-collider}, and {@link n.n-mesh-collider}. You cannot use\r\n\t* this class directly, but instead you should add one of those components\r\n\t* to your objects.\r\n\t* @name n-collider\r\n\t* @mixin n-collider\r\n\t* @memberof native\r\n\t* @prop {vec3} center=0,0,0 - The offset of the collider in local space.\r\n\t* @prop {string} type=hologram - The type of collider, one of: `object` | `environment` | `hologram`.\r\n\t* Object colliders collide with other objects, the environment, and the cursor.\r\n\t* Environment colliders collide with everything objects do, but you can also\r\n\t* teleport onto them. Hologram colliders only collide with other holograms and\r\n\t* the cursor.\r\n\t*/\r\n\r\n\t/**\r\n\t* Create a spherical collider on this entity.\r\n\t* @mixin n-sphere-collider\r\n\t* @memberof native\r\n\t* @extends native.n-collider\r\n\t* @prop {number} radius=1 - The size of the collider in meters.\r\n\t*/\r\n\tAFRAME.registerComponent('n-sphere-collider', {\r\n\t\tinit:nativeComponentInit,\r\n\t\tremove: nativeComponentRemove,\r\n\t\tupdate: nativeComponentUpdate,\r\n\t\tschema: {\r\n\t\t\tisTrigger: { default: false, type: 'boolean' },\r\n\t\t\tcenter: { type: 'vec3' },\r\n\t\t\tradius: { default: '0', type: 'number' },\r\n\t\t\ttype: {default: 'object'}\r\n\t\t}\r\n\t});\r\n\r\n\r\n\t/**\r\n\t* Create a box-shaped collider on this entity.\r\n\t* @mixin n-box-collider\r\n\t* @memberof native\r\n\t* @extends native.n-collider\r\n\t* @prop {vec3} size=1,1,1 - The dimensions of the collider.\r\n\t*/\r\n\tAFRAME.registerComponent('n-box-collider', {\r\n\t\tinit:nativeComponentInit,\r\n\t\tremove: nativeComponentRemove,\r\n\t\tupdate: nativeComponentUpdate,\r\n\t\tschema: {\r\n\t\t\tisTrigger: { default: false, type: 'boolean' },\r\n\t\t\tcenter: { type: 'vec3' },\r\n\t\t\tsize: { type: 'vec3' },\r\n\t\t\ttype: {default: 'object'}\r\n\t\t}\r\n\t});\r\n\r\n\t/**\r\n\t* Create a capsule-shaped collider on this entity. Capsules\r\n\t* are a union of a cylinder and two spheres on top and bottom.\r\n\t* @mixin n-capsule-collider\r\n\t* @memberof native\r\n\t* @extends native.n-collider\r\n\t* @prop {number} radius=1 - The radius of the capsule in meters.\r\n\t* @prop {number} height=1 - The height of the shaft of the capsule in meters.\r\n\t* @prop {string} direction=y - The axis with which the capsule is aligned.\r\n\t* One of `x`, `y`, or `z`.\r\n\t*/\r\n\tAFRAME.registerComponent('n-capsule-collider', {\r\n\t\tinit:nativeComponentInit,\r\n\t\tremove: nativeComponentRemove,\r\n\t\tupdate: nativeComponentUpdate,\r\n\t\tschema: {\r\n\t\t\tisTrigger: { default: false, type: 'boolean' },\r\n\t\t\tcenter: { type: 'vec3' },\r\n\t\t\tradius: { default: '0', type: 'number' },\r\n\t\t\theight: { default: '0', type: 'number' },\r\n\t\t\tdirection: { default: 'y' },\r\n\t\t\ttype: {default: 'object'}\r\n\t\t}\r\n\t});\r\n\r\n\t/**\r\n\t* Enable collision for the entire attached mesh. This is expensive to evaluate, so should only be used on\r\n\t* low-poly meshes.\r\n\t* @mixin n-mesh-collider\r\n\t* @memberof native\r\n\t* @extends native.n-collider\r\n\t* @example <a-box n-mesh-collider></a-box>\r\n\t* @prop {bool} convex=true - Whether the collider should be convex or concave. Set this to false if you have holes\r\n\t* in your mesh. Convex colliders are limited to 255 triangles. Note: concave colliders can be significantly more\r\n\t* expensive comparet to conves colliders.\r\n\t*/\r\n\tAFRAME.registerComponent('n-mesh-collider', {\r\n\t\t_forEachMesh: function (func) {\r\n\t\t\tvar obj = this.el.object3DMap.mesh;\r\n\t\t\tif (!obj) { return; }\r\n\t\t\tif (obj instanceof THREE.Mesh) {\r\n\t\t\t\tfunc(obj);\r\n\t\t\t}\r\n\t\t\tobj.traverse(function (childObj) {\r\n\t\t\t\tif (childObj instanceof THREE.Mesh) {\r\n\t\t\t\t\tfunc(childObj);\r\n\t\t\t\t}\r\n\t\t\t}.bind(this));\r\n\t\t},\r\n\t\t_initObj: function () {\r\n\t\t\tthis._forEachMesh(function (mesh) {\r\n\t\t\t\tmeshInit.call(this, mesh);\r\n\r\n\t\t\t\t//to pass defaults\r\n\t\t\t\taltspace.updateNativeComponent(mesh, this.name, this.data);\r\n\t\t\t}.bind(this));\r\n\t\t},\r\n\t\tinit: function () {\r\n\t\t\t// Allow a-frame to create a PlaceholderMesh if there isn't already one, so that the native collider is\r\n\t\t\t// registered.\r\n\t\t\tthis.el.getOrCreateObject3D('mesh', PlaceholderMesh);\r\n\r\n\t\t\t// Initialize the existing mesh\r\n\t\t\tthis._initObj();\r\n\r\n\t\t\tthis.el.addEventListener('model-loaded', function () {\r\n\t\t\t\t// Re-initialize the collider if a new model is loaded\r\n\t\t\t\tthis._initObj();\r\n\t\t\t}.bind(this));\r\n\t\t},\r\n\t\tremove: function () {\r\n\t\t\tthis._forEachMesh(function (mesh) {\r\n\t\t\t\taltspace.removeNativeComponent(mesh, this.name);\r\n\t\t\t}.bind(this));\r\n\t\t},\r\n\t\tupdate: function (oldData) {\r\n\t\t\tthis._forEachMesh(function (mesh) {\r\n\t\t\t\taltspace.updateNativeComponent(mesh, this.name, this.data);\r\n\t\t\t}.bind(this));\r\n\t\t},\r\n\t\tschema: {\r\n\t\t\tisTrigger: { default: false, type: 'boolean' },\r\n\t\t\tconvex: { default: true, type: 'boolean' },\r\n\t\t\ttype: {default: 'object'}\r\n\t\t}\r\n\t});\r\n\r\n\t/**\r\n\t* Make the object's +Z always face the viewer. Currently will only directly apply to main mesh or native component on the attached entity, not any children or submeshes.\r\n\t* @mixin n-billboard\r\n\t* @memberof native\r\n\t* @example <a-plane n-billboard></a-plane>\r\n\t*/\r\n\tAFRAME.registerComponent('n-billboard', {\r\n\t\tinit:nativeComponentInit,\r\n\t\tremove: nativeComponentRemove,\r\n\t});\r\n\r\n\t/**\r\n\t* A container keeps a running tally of how many objects are within\r\n\t* its bounds, and adds and removes the states `container-full` and\r\n\t* `container-empty` based on the current count of objects. Can fire three\r\n\t* special events: `container-full`, `container-empty`, and `container-count-changed`.\r\n\t* @mixin n-container\r\n\t* @memberof native\r\n\t* @prop {number} capacity=4 - The value at which the container will fire the\r\n\t* `container-full` event.\r\n\t*/\r\n\tAFRAME.registerComponent('n-container', {\r\n\t\tinit: function(){\r\n\t\t\tnativeComponentInit.call(this);\r\n\r\n\t\t\tvar el = this.el;\r\n\t\t\tvar component = this;\r\n\r\n\t\t\tel.addEventListener('stateadded', function(event){\r\n\t\t\t\tif(event.detail.state === 'container-full'){\r\n\t\t\t\t\tel.emit('container-full');\r\n\t\t\t\t}\r\n\t\t\t\tif(event.detail.state === 'container-empty'){\r\n\t\t\t\t\tel.emit('container-empty');\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tel.addEventListener('container-count-changed', function(event){\r\n\t\t\t\tcomponent.count = event.detail.count;\r\n\t\t\t});\r\n\t\t},\r\n\t\tremove: nativeComponentRemove,\r\n\t\tupdate: nativeComponentUpdate,\r\n\t\tschema: {\r\n\t\t\tcapacity: { default: 4, type: 'number' },\r\n\t\t}\r\n\t});\r\n\r\n\t/**\r\n\t* Play the sound given by the `src` or `res` property from the location\r\n\t* of the entity.\r\n\t* @mixin n-sound\r\n\t* @memberof native\r\n\t* @prop {string} res - The resource identifier for a built-in sound clip.\r\n\t* @prop {string} src - A URL to an external sound clip. The sound can be in WAV, OGG or MP3 format. However. only\r\n\t* WAV is supported on all platforms. MP3 is supported on Gear VR and OGG is supported on desktop.\r\n\t* @prop {string} on - The name of the event that will play this sound clip.\r\n\t* @prop {boolean} loop=false - Tells the clip to loop back to the beginning of the clip\r\n\t* once it's finished.\r\n\t* @prop {boolean} autoplay=false - Tells the clip to start automatically when\r\n\t* the scene loads, instead of waiting for `playSound()`.\r\n\t* @prop {boolean} oneshot=false - Tells the clip to clean itself up when it\r\n\t* finishes playing. Allows for overlapping instances of the sound.\r\n\t* @prop {number} volume=1 - The volume of the clip, from [0,1].\r\n\t* @prop {number} spatialBlend=1 - How spatialized a sound is, from [0,1].\r\n\t* A value of 1 will be fully localized, and the sound will pan left and\r\n\t* right as you turn your head. A value of 0 makes it non-spatialized, and\r\n\t* it will always be heard in both ears.\r\n\t* @prop {number} pitch=1 - The speed multiplier for the sound. 0.5 is one\r\n\t* octave down, and 2 is one octave up.\r\n\t* @prop {number} minDistance=1 - Inside this distance in meters,\r\n\t* the sound volume is at full volume.\r\n\t* @prop {number} maxDistance=12 - If rolloff is 'logarithmic', the sound will stop attenuating at this distance.\r\n\t* If rolloff is 'linear' or 'cosine', the sound will be silent at this distance.\r\n\t* @prop {string} rolloff='logarithmic' - Set this to 'linear' or 'cosine' if you want to cut sounds off at a\r\n\t* maxDistance.\r\n\t*/\r\n\t/**\r\n\t* Fired when a sound has loaded and is ready to be played\r\n\t* @event native.n-sound#n-sound-loaded\r\n\t*/\r\n\tAFRAME.registerComponent('n-sound', {\r\n\t\tinit: function () {\r\n\t\t\tvar src = this.data.src;\r\n\t\t\tif (src && !src.startsWith('http')) {\r\n\t\t\t\tif (src.startsWith('/')) {\r\n\t\t\t\t\tthis.data.src = location.origin + src;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tvar currPath = location.pathname;\r\n\t\t\t\t\tif (!currPath.endsWith('/')) {\r\n\t\t\t\t\t\tcurrPath = location.pathname.split('/').slice(0, -1).join('/') + '/';\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.data.src = location.origin + currPath + src;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tnativeComponentInit.call(this);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t* Stop the playing sound, and preserve position in clip.\r\n\t\t* @method native.n-sound#pauseSound\r\n\t\t*/\r\n\t\tpauseSound: function () {\r\n\t\t\tcallComponent.call(this, 'pause');\r\n\t\t\tthis.el.emit('sound-paused');\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t* Start the sound playing.\r\n\t\t* @method native.n-sound#playSound\r\n\t\t*/\r\n\t\tplaySound: function () {\r\n\t\t\tcallComponent.call(this, 'play');\r\n\t\t\tthis.el.emit('sound-played');\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t* Jump to a position in the clip.\r\n\t\t* @method native.n-sound#seek\r\n\t\t* @param {number} time - The time in milliseconds to jump to.\r\n\t\t*/\r\n\t\tseek: function (time) {\r\n\t\t\tcallComponent.call(this, 'seek', {time: time});\r\n\t\t},\r\n\t\tremove: function () {\r\n\t\t\tnativeComponentRemove.call(this);\r\n\t\t\tif (this.playHandler) {\r\n\t\t\t  this.el.removeEventListener(oldData.on, this.playHandler);\r\n\t\t\t}\r\n\t\t},\r\n\t\tupdate: function (oldData) {\r\n\t\t\tnativeComponentUpdate.call(this, oldData);\r\n\t\t\tif (this.playHandler) {\r\n\t\t\t  this.el.removeEventListener(oldData.on, this.playHandler);\r\n\t\t\t}\r\n\t\t\tif (this.data.on) {\r\n\t\t\t  this.playHandler = this.playSound.bind(this);\r\n\t\t\t  this.el.addEventListener(this.data.on, this.playHandler);\r\n\t\t\t}\r\n\t\t},\r\n\t\tschema: {\r\n\t\t\ton: { type: 'string' },\r\n\t\t\tres: { type: 'string' },\r\n\t\t\tsrc: { type: 'string' },\r\n\t\t\tloop: { type: 'boolean' },\r\n\t\t\tvolume: { type: 'number', default: 1 },\r\n\t\t\tautoplay: { type: 'boolean' },\r\n\t\t\toneshot: { type: 'boolean' },\r\n\t\t\tspatialBlend: { type: 'float', default: 1 },\r\n\t\t\tpitch: { type: 'float', default: 1 },\r\n\t\t\tminDistance: { type: 'float', default: 1 },\r\n\t\t\tmaxDistance: { type: 'float', default: 12 },\r\n\t\t\trolloff: { type: 'string', default: 'logarithmic' },\r\n\t\t}\r\n\t});\r\n\r\n})();\r\n\r\nexport default null;\r\n","/**\r\n * The wire component allows you to trigger an event on another entity when an event occurs on an entity\r\n * @mixin wire\r\n * @property {string} on Name of an event to listen to\r\n * @property {string} gained Name of a state to watch for\r\n * @property {string} lost Name of a state to watch for\r\n * @property {string} emit Name of an event to trigger on the targets\r\n * @property {string} gain Name of a state to add on the target\r\n * @property {string} lose Name of a state to remove on the target\r\n * @property {selector} targets A selector to pick which objects to wire to\r\n * @property {selector} target - A selector to pick a single object to wire to\r\n **/\r\nAFRAME.registerComponent('wire',\r\n{\r\n\tmultiple: true,\r\n\tschema: {\r\n\t\ton: {type: 'string'},\r\n\t\temit: {type: 'string'},\r\n\t\tgained: {type: 'string'},\r\n\t\tlost: {type: 'string'},\r\n\t\tgain: {type: 'string'},\r\n\t\tlose: {type: 'string'},\r\n\t\ttargets: {type: 'selectorAll'},\r\n\t\ttarget: {type: 'selector'}\r\n\t},\r\n\tupdate: function (oldData) {\r\n\t\tif (oldData.on) {\r\n\t\t\tthis.el.removeEventListener(oldData.on, this.actOnTargets);\r\n\t\t}\r\n\t\tif (oldData.gained) {\r\n\t\t\tthis.el.removeEventListener('stateadded', this.actOnTargetsIfStateMatches);\r\n\t\t}\r\n\t\tif (oldData.lost) {\r\n\t\t\tthis.el.removeEventListener('stateremoved', this.actOnTargetsIfStateMatches);\r\n\t\t}\r\n\r\n\t\tthis.actOnTargets = function () {\r\n\t\t\tfunction act(el) {\r\n\t\t\t\tif (this.data.emit) {\r\n\t\t\t\t\tel.emit(this.data.emit);\r\n\t\t\t\t}\r\n\t\t\t\tif (this.data.gain) {\r\n\t\t\t\t\tel.addState(this.data.gain);\r\n\t\t\t\t}\r\n\t\t\t\tif (this.data.lose) {\r\n\t\t\t\t\tel.removeState(this.data.lose);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(this.data.targets) this.data.targets.forEach(act.bind(this));\r\n\t\t\tif(this.data.target) act.call(this, this.data.target);\r\n\t\t}.bind(this);\r\n\r\n\t\tthis.actOnTargetsIfStateMatches = function (event) {\r\n\t\t\tvar state = event.detail.state;\r\n\t\t\tif (state === this.data.gained || state === this.data.lost) {\r\n\t\t\t\tthis.actOnTargets();\r\n\t\t\t}\r\n\t\t}.bind(this);\r\n\r\n\t\tif (this.data.on) {\r\n\t\t\tthis.el.addEventListener(this.data.on, this.actOnTargets);\r\n\t\t}\r\n\t\tif (this.data.gained) {\r\n\t\t\tthis.el.addEventListener('stateadded', this.actOnTargetsIfStateMatches);\r\n\t\t}\r\n\t\tif (this.data.lost) {\r\n\t\t\tthis.el.addEventListener('stateremoved', this.actOnTargetsIfStateMatches);\r\n\t\t}\r\n\t},\r\n\tremove: function () {\r\n\t\tthis.el.removeEventListener(this.data.on, this.actOnTargets);\r\n\t\tthis.el.removeEventListener('stateadded', this.actOnTargetsIfStateMatches);\r\n\t\tthis.el.removeEventListener('stateremoved', this.actOnTargetsIfStateMatches);\r\n\t}\r\n});\r\n\r\nexport default null;\r\n","/**\r\n* @module altspace/components\r\n*/\r\n\r\n'use strict';\r\n\r\nimport {registerComponentClass, registerSystemClass, flatten} from './AFrameComponent';\r\nimport AltspaceCursorCollider from './AltspaceCursorCollider';\r\nimport AltspaceTrackedControls from './AltspaceTrackedControls';\r\nimport AltspaceComponent from './AltspaceComponent';\r\nimport SyncColor from './SyncColor';\r\nimport SyncComponent from './SyncComponent';\r\nimport SyncSystem from './SyncSystem';\r\nimport SyncTransform from './sync-transform';\r\nimport SyncNSound from './sync-n-sound';\r\nimport NativeComponents from './native-components';\r\nimport Wire from './wire';\r\n\r\n// TODO: finish porting aframe components to es6\r\nif (window.AFRAME)\r\n{\r\n    /**\r\n    * @mixin sync-system\r\n    * @memberof module:altspace/components\r\n    * @see {@link module:altspace/components.SyncSystem}\r\n    */\r\n    registerSystemClass('sync-system', SyncSystem);\r\n\r\n    registerComponentClass('altspace-cursor-collider', AltspaceCursorCollider);\r\n    registerComponentClass('altspace-tracked-controls', AltspaceTrackedControls);\r\n    registerComponentClass('altspace', AltspaceComponent);\r\n    registerComponentClass('sync-color', SyncColor);\r\n    registerComponentClass('sync', SyncComponent);\r\n\r\n}\r\n\r\nexport {AltspaceComponent, AltspaceCursorCollider, AltspaceTrackedControls, SyncSystem, SyncComponent, SyncColor, flatten };\r\n","/**\r\n * The Sync utility is currently based on Firebase. It provides a quick way\r\n * to synchronize apps between users (even when they are running outside of\r\n * AltspaceVR).\r\n * During the SDK beta, please consider all data stored with the sync\r\n * utility to be ephemeral (it may be cleared or clobbered at any time).\r\n * You do not need a Firebase account to use the Sync utility.\r\n *\r\n *\r\n * Refer to the [Firebase API documentation](https://www.firebase.com/docs/web/api/)\r\n * when working with the sync instance.\r\n * @module altspace/utilities/sync\r\n */\r\n\r\nlet Firebase = window.Firebase;\r\nlet inAltspace = altspace && altspace.inClient;\r\nlet canonicalUrl = getCanonicalUrl();\r\n\r\nlet instance;\r\n\r\nfunction dashEscape(keyName) {\r\n\treturn keyName ? encodeURIComponent(keyName).replace(/\\./g, '%2E').replace(/%[A-Z0-9]{2}/g, '-') : null;\r\n}\r\n\r\nfunction getCanonicalUrl() {\r\n\tvar canonicalElement = document.querySelector('link[rel=canonical]');\r\n\treturn canonicalElement ? canonicalElement.href : window.location.href;\r\n}\r\n\r\nfunction getProjectId(appId, authorId, canonicalUrl) {\r\n\treturn dashEscape(authorId || canonicalUrl) + ':' + dashEscape(appId || '');\r\n}\r\n\r\n\r\n/**\r\n* Retreived\r\n* via [altspace.utilities.sync.connect]{@link module:altspace/utilities/sync#connect}.\r\n* @class module:altspace/utilities/sync~Connection\r\n* @memberof module:altspace/utilities/sync\r\n*/\r\n\r\n/**\r\n* (In-client only) A Firebase reference for the current user (on a per app basis). This can be used for things like a persistent inventory or personal highscores.\r\n* @instance\r\n* @member {Firebase} user\r\n* @memberof module:altspace/utilities/sync~Connection\r\n*/\r\n\r\n/**\r\n* A Firebase reference to the current instance of the app.\r\n* This will change if the query paramater is removed through navigation, rebeaming, the space timing out, or other reasons.\r\n* This can be used as an input to SceneSync\r\n* @instance\r\n* @member {Firebase} instance\r\n* @memberof module:altspace/utilities/sync~Connection\r\n*/\r\n\r\n/**\r\n* (In-client only) A Firebase reference for the current space. Especially useful if multiple apps / instances need to communicate inside the space.\r\n* @instance\r\n* @member {Firebase} space\r\n* @memberof module:altspace/utilities/sync~Connection\r\n*/\r\n\r\n/**\r\n* A Firebase reference for the app.\r\n* This can be used for things like persistent high-scores, dynamic configuration, or inter-instance communication.\r\n* @instance\r\n* @member {Firebase} app\r\n* @memberof module:altspace/utilities/sync~Connection\r\n*/\r\n\r\n\r\n/**\r\n* Connect to a sync session to obtain Firebase references that can be used for syncronization of real-time and persistent state.\r\n* Returns a promise that will fulfill with a [Connection]{@link module:altspace/utilities/sync~Connection}.\r\n*\r\n* @method connect\r\n* @param {Object} config\r\n* @param {String} config.authorId A unique identifier for yourself or your organization\r\n* @param {String} config.appId The name of your app\r\n* @param {String} [config.baseRefUrl] Override the base reference. Set this to use your own Firebase.\r\n* @param {String} [config.instanceId] Override the instanceId. Can also be overriden using a query parameter.\r\n* @param {String} [config.spaceId] Override the spaceId. Can also be overriden using a query parameter.\r\n* @param {String} [config.userId] Override the userId. Can also be overriden using a query parameter.\r\n* @return {Promise}\r\n* @memberof module:altspace/utilities/sync\r\n**/\r\n//todo clients\r\nfunction connect(config)\r\n{\r\n\tconfig = config || {};\r\n\r\n\tvar url = new Url();\r\n\r\n\t// Our ref used for example apps. Data may be cleared periodically.\r\n\tvar baseRefUrl = config.baseRefUrl || 'https://altspace-apps.firebaseio.com/apps/examples/';\r\n\tvar baseRef = new Firebase(baseRefUrl);\r\n\r\n\t// Gather query paramaters (some may only be used as testing overrides)\r\n\tvar instanceId = config.instanceId || url.query['altspace-sync-instance'];\r\n\tvar spaceId = config.spaceId || url.query['altspace-sync-space'];\r\n\tvar userId = config.userId || url.query['altspace-sync-user'];\r\n\r\n\tif (!config.appId || !config.authorId) {\r\n\t\tthrow new Error('Both the appId and authorId must be provided to connect.');\r\n\t}\r\n\r\n\tvar tasks = [];\r\n\tif (inAltspace) {\r\n\t\tif (!spaceId) tasks.unshift(altspace.getSpace());\r\n\t\tif (!userId) tasks.unshift(altspace.getUser());\r\n\t}\r\n\r\n\tfunction getRefs() {\r\n\t\tvar refs = {};\r\n\r\n\t\tvar projectId = getProjectId(config.appId, config.authorId, canonicalUrl);\r\n\t\trefs.app = baseRef.child(projectId).child('app');\r\n\t\trefs.space = spaceId ? refs.app.child('spaces').child(spaceId) : null;\r\n\t\trefs.user = userId ? refs.app.child('users').child(userId) : null;\r\n\r\n\t\tvar instancesRef = refs.app.child('instances');\r\n\t\tif (instanceId) {\r\n\t\t\trefs.instance = instancesRef.child(instanceId);\r\n\t\t} else {\r\n\t\t\trefs.instance = instancesRef.push();\r\n\t\t\tinstanceId = refs.instance.key();\r\n\t\t}\r\n\t\treturn refs;\r\n\t}\r\n\r\n\tfunction updateUrl() {\r\n\t\tif (!url.query['altspace-sync-instance']) {\r\n\t\t\turl.query['altspace-sync-instance'] = instanceId;\r\n\t\t\twindow.location.href = url.toString();\r\n\t\t}\r\n\t}\r\n\r\n\treturn Promise.all(tasks).then(function (results) {\r\n\t\tif (inAltspace) {\r\n\t\t\tif (!spaceId) spaceId = results.pop().sid;\r\n\t\t\tif (!userId) userId = results.pop().userId;\r\n\t\t}\r\n\r\n\t\tspaceId = dashEscape(spaceId);\r\n\t\tuserId = dashEscape(userId);\r\n\t\tinstanceId = dashEscape(instanceId);\r\n\r\n\t\tvar connection = getRefs();\r\n\r\n\t\tupdateUrl();\r\n\r\n\t\treturn connection;\r\n\t});\r\n}\r\n\r\nexport { connect };\r\n","/**\r\n* Detects mouse move/up/down events, raycasts to find intersected objects,\r\n* then dispatches cursor move/up/down/enter/leave events that mimics\r\n* Altspace events.\r\n* @module altspace/utilities/shims/cursor\r\n*/\r\n'use strict';\r\n\r\nvar scene;\r\nvar camera;\r\nvar domElem;\r\n\r\nvar overObject;\r\n\r\nvar raycaster = new THREE.Raycaster();\r\n\r\n/**\r\n * Initializes the cursor module\r\n * @static\r\n * @method init\r\n * @param {THREE.Scene} scene\r\n * @param {THREE.Camera} camera - Camera used for raycasting.\r\n * @param {Object} [options] - An options object\r\n * @param {THREE.WebGLRenderer} [options.renderer] - If supplied, applies cursor movement to render target\r\n *\tinstead of entire client\r\n * @memberof module:altspace/utilities/shims/cursor\r\n */\r\nfunction init(_scene, _camera, _params) {\r\n\tif (!_scene || !_scene instanceof THREE.Scene) {\r\n\t\tthrow new TypeError('Requires THREE.Scene argument');\r\n\t}\r\n\tif (!_camera || !_camera instanceof THREE.Camera) {\r\n\t\tthrow new TypeError('Requires THREE.Camera argument');\r\n\t}\r\n\tscene = _scene;\r\n\tcamera = _camera;\r\n\r\n\tp = _params || {};\r\n\tdomElem = p.renderer && p.renderer.domElement || window;\r\n\r\n\tdomElem.addEventListener('mousedown', mouseDown, false)\r\n\tdomElem.addEventListener('mouseup', mouseUp, false)\r\n\tdomElem.addEventListener('mousemove', mouseMove, false)\r\n}\r\n\r\nfunction mouseDown(event) {\r\n\r\n\tvar intersection = findIntersection(event);\r\n\tif (!intersection || !intersection.point) return;\r\n\r\n\tvar cursorEvent = createCursorEvent('cursordown', intersection);\r\n\tintersection.object.dispatchEvent(cursorEvent);\r\n}\r\n\r\nfunction mouseUp(event) {\r\n\tvar intersection = findIntersection(event);\r\n\r\n\tvar cursorEvent = createCursorEvent('cursorup', intersection);\r\n\r\n\tif (intersection) {\r\n\t\tintersection.object.dispatchEvent(cursorEvent);\r\n\t} else {\r\n\t\tscene.dispatchEvent(cursorEvent);\r\n\t}\r\n}\r\n\r\nfunction mouseMove(event) {\r\n\tvar intersection = findIntersection(event);\r\n\r\n\tvar cursorEvent = createCursorEvent('cursormove', intersection);//TODO improve and don't fire only on scene\r\n\tscene.dispatchEvent(cursorEvent);\r\n\r\n\tvar object = intersection ? intersection.object : null;\r\n\tif (overObject != object) {\r\n\t\tif (overObject) {\r\n\t\t\tcursorEvent = createCursorEvent('cursorleave', intersection);\r\n\t\t\toverObject.dispatchEvent(cursorEvent);\r\n\t\t}\r\n\r\n\t\tif (object) {\r\n\t\t\tcursorEvent = createCursorEvent('cursorenter', intersection);\r\n\t\t\tobject.dispatchEvent(cursorEvent);\r\n\t\t}\r\n\r\n\t\toverObject = object;\r\n\t}\r\n}\r\n\r\nfunction createCursorEvent(type, intersection) {\r\n\treturn {\r\n\t\ttype: type,\r\n\t\tbubbles: true,\r\n\t\ttarget: intersection ? intersection.object : null,\r\n\t\tray: {\r\n\t\t\torigin: raycaster.ray.origin.clone(),\r\n\t\t\tdirection: raycaster.ray.direction.clone()\r\n\t\t},\r\n\t\tpoint: intersection ? intersection.point.clone() : null\r\n\t}\r\n}\r\n\r\nfunction findIntersection(mouseEvent) {\r\n\tvar mouse = new THREE.Vector2();\r\n\tmouse.x = (mouseEvent.offsetX / (domElem.width || domElem.innerWidth)) * 2 - 1;\r\n\tmouse.y = -(mouseEvent.offsetY / (domElem.height || domElem.innerHeight)) * 2 + 1;\r\n\r\n\traycaster.setFromCamera(mouse, camera);\r\n\r\n\tvar intersections = raycaster.intersectObjects(scene.children, true);\r\n\r\n\t// return the first object with an enabled collider\r\n\treturn intersections.find(function(e){\r\n\t\treturn !e.object.userData\r\n\t\t\t|| !e.object.userData.altspace\r\n\t\t\t|| !e.object.userData.altspace.collider\r\n\t\t\t|| e.object.userData.altspace.collider.enabled !== false;\r\n\t}) || null;\r\n}\r\n\r\nexport {init};\r\n","window.altspace = window.altspace || {};\r\nwindow.altspace.utilities = window.altspace.utilities || {};\r\n\r\nimport * as CursorShim from './shims/cursor';\r\n\r\n/**\r\n* @module altspace/utilities\r\n*/\r\n\r\n/**\r\n* Simulation is a helper class that lets you quickly setup a three.js app with support for AltspaceVR. It creates a basic scene for you and starts the render and behavior loop.\r\n*\r\n* If all of your application logic is in behaviors, you do not need to create any additional requestAnimationFrame loops.\r\n*\r\n* It also automatically uses the WebGL renderer when running in a\r\n* desktop browser and emulates cursor events with mouse clicks.\r\n* @class Simulation\r\n* @param {Object} [config] Optional parameters.\r\n* @param {Boolean} [config.auto=true] Automatically start the render loop.\r\n* @memberof module:altspace/utilities\r\n*/\r\nclass Simulation\r\n{\r\n\tconstructor({auto = true})\r\n\t{\r\n\t\tthis._scene = null;\r\n\t\tthis._renderer = null;\r\n\t\tthis._camera = null;\r\n\r\n\t\tlet usingAFrame = window.AFRAME && document.querySelector('a-scene');\r\n\r\n\t\tif(usingAFrame)\r\n\t\t{\r\n\t\t\tlet ascene = document.querySelector('a-scene');\r\n\t\t\tthis._scene = ascene.object3D;\r\n\t\t\tthis._renderer = ascene.renderer;\r\n\r\n\t\t\tlet acamera = document.querySelector('a-camera');\r\n\t\t\tif(acamera)\r\n\t\t\t\tthis._camera = acamera.object3D;\r\n\t\t}\r\n\t\telse if (window.altspace && altspace.inClient)\r\n\t\t{\r\n\t\t\tthis._scene = new THREE.Scene();\r\n\t\t\tthis._renderer = altspace.getThreeJSRenderer();\r\n\t\t\tthis._camera = new THREE.PerspectiveCamera(); // TODO: change from shim to symbolic\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis._setupWebGL();\r\n\t\t}\r\n\r\n\t\tif(auto && !usingAFrame)\r\n\t\t\tthis.loop();\r\n\t}\r\n\r\n\t_setupWebGL()\r\n\t{\r\n\t\tlet scene = this._scene = new THREE.Scene();\r\n\t\tlet renderer = this._renderer = new THREE.WebGLRenderer({antialias: true});\r\n\t\tlet camera = this._camera = new THREE.PerspectiveCamera();\r\n\r\n\t\tdocument.addEventListener(\"DOMContentLoaded\", event => {\r\n\t\t\tdocument.body.style.margin = '0px';\r\n\t\t\tdocument.body.style.overflow = 'hidden';\r\n\t\t\trenderer.setClearColor('#035F72');\r\n\t\t\tlet container = document.createElement('div');\r\n\t\t\tdocument.body.appendChild(container);\r\n\t\t\tcontainer.appendChild(renderer.domElement);\r\n\t\t});\r\n\r\n\t\tfunction resizeRender(){\r\n\t\t\tcamera.aspect = window.innerWidth / window.innerHeight;\r\n\t\t\tcamera.updateProjectionMatrix();\r\n\t\t\trenderer.setSize(window.innerWidth, window.innerHeight);\r\n\t\t}\r\n\t\twindow.addEventListener('resize', resizeRender);\r\n\t\tresizeRender();\r\n\r\n\t\tcamera.position.z = 500;\r\n\t\tcamera.fov = 45;\r\n\t\tcamera.near = 1;\r\n\t\tcamera.far = 2000;\r\n\t\tscene.add(camera);\r\n\t\tscene.add(new THREE.AmbientLight('white'));\r\n\r\n\t\t// shim cursor\r\n\t\tthis.cursor = CursorShim.init(scene, camera);\r\n\t}\r\n\r\n\t/**\r\n\t* Begin the simulation. This loop is begun automatically by default.\r\n\t*/\r\n\tloop()\r\n\t{\r\n\t\twindow.requestAnimationFrame(this.loop.bind(this));\r\n\r\n\t\tif(this.scene.updateAllBehaviors)\r\n\t\t\tthis.scene.updateAllBehaviors();\r\n\r\n\t\tthis.renderer.render(this.scene, this.camera);\r\n\t}\r\n\r\n\t/**\r\n\t* The simulation scene.\r\n\t* @readonly\r\n\t* @instance\r\n\t* @member {THREE.Scene} scene\r\n\t* @memberof module:altspace/utilities.Simulation\r\n\t*/\r\n\tget scene(){ return this._scene; }\r\n\r\n\t/**\r\n\t* The renderer being used.\r\n\t* @readonly\r\n\t* @instance\r\n\t* @member {(THREE.WebGLRenderer|AltRenderer)} renderer\r\n\t* @memberof module:altspace/utilities.Simulation\r\n\t*/\r\n\tget renderer(){ return this._renderer; }\r\n\r\n\t/**\r\n\t* The camera being used by the WebGL renderer.\r\n\t* @readonly\r\n\t* @instance\r\n\t* @member {Three.Camera} camera\r\n\t* @memberof module:altspace/utilities.Simulation\r\n\t*/\r\n\tget camera(){ return this._camera; }\r\n\r\n}\r\n\r\nexport default Simulation;\r\n","'use strict';\r\n\r\nvar loader;\r\nvar TRACE;\r\nvar baseUrl = '';\r\nvar crossOrigin = '';//assigned to THREE.MTLLoader.crossOrigin\r\n\r\nfunction LoadRequest(){\r\n\t//To create loadRequst: new MultiLoader.LoadRequest()\r\n\r\n\tvar objUrls = [];//Paths to model geometry file, in Wavefront OBJ format.\r\n\tvar mtlUrls = [];//Paths to model materials file, in Wavefront MTL format.\r\n\tvar objects = [];//objects[i] is result of loader.load(objUrl[i], mtlUrl[i])\r\n\tvar error;//String indicating loading error with at least one file.\r\n\tvar objectsLoaded = 0;//Used internally to determine when loading complete.\r\n\r\n\treturn {\r\n\t\tobjUrls: objUrls,\r\n\t\tmtlUrls: mtlUrls,\r\n\t\tobjects: objects,\r\n\t\terror: error,\r\n\t\tobjectsLoaded: objectsLoaded\r\n\t};\r\n\r\n}//end of LoadRequest\r\n\r\nfunction init(params){\r\n\tvar p = params || {};\r\n\tTRACE = p.TRACE || false;\r\n\tif (p.crossOrigin) crossOrigin = p.crossOrigin;\r\n\tif (p.baseUrl) baseUrl = p.baseUrl;\r\n\tif (baseUrl.slice(-1) !== '/') baseUrl += '/';\r\n\r\n\tloader = new altspace.utilities.shims.OBJMTLLoader();\r\n\tloader.crossOrigin = crossOrigin;\r\n\tif (TRACE) console.log('MultiLoader initialized with params', params);\r\n}\r\n\r\nfunction load(loadRequest, onComplete){\r\n\tvar req = loadRequest;\r\n\tvar start = Date.now();\r\n\tif (!req || !req instanceof LoadRequest){\r\n\t\tthrow new Error('MultiLoader.load expects first arg of type LoadRequest');\r\n\t}\r\n\tif (!onComplete || typeof(onComplete) !== 'function'){\r\n\t\tthrow new Error('MultiLoader.load expects second arg of type function');\r\n\t}\r\n\tif (!req.objUrls || !req.mtlUrls || req.objUrls.length !== req.mtlUrls.length){\r\n\t\tthrow new Error('MultiLoader.load called with bad LoadRequest');\r\n\t}\r\n\tvar reqCount = req.objUrls.length;\r\n\tif (TRACE) console.log('Loading models...')\r\n\tfor (var i=0; i < reqCount; i++){\r\n\t\tvar loadModel = function(req, i){//We need i in the closure to store result.\r\n\t\t\tvar objUrl = baseUrl + req.objUrls[i];\r\n\t\t\tvar mtlUrl = baseUrl + req.mtlUrls[i];\r\n\t\t\tif (TRACE) console.log('Loading obj:'+objUrl+', mtl:'+mtlUrl);\r\n\t\t\tloader.load(objUrl, mtlUrl, function(object3d){//onLoaded\r\n\t\t\t\treq.objects[i] = object3d;\r\n\t\t\t\treq.objectsLoaded++;\r\n\t\t\t\tif(req.objectsLoaded === reqCount){\r\n\t\t\t\t\tvar elapsed = ((Date.now()-start)/1000.0).toFixed(2);\r\n\t\t\t\t\tif (TRACE) console.log('Loaded '+reqCount+' models in '+elapsed+' seconds');\r\n\t\t\t\t\tonComplete();\r\n\t\t\t\t}\r\n\t\t\t}, onProgress, function(){//onError\r\n\t\t\t\tvar url = xhr.target.responseURL || '';\r\n\t\t\t\treq.error = 'Error loading file '+url;\r\n\t\t\t});\r\n\t\t};\r\n\t\tloadModel(req, i);\r\n\t}\r\n}\r\n\r\nfunction onProgress(xhr){\r\n\tif (xhr.lengthComputable && xhr.target.responseURL) {\r\n\t\t//Skip progress log if no xhr url, meaning it's a local file.\r\n\t\tvar percentComplete = xhr.loaded / xhr.total * 100;\r\n\t\tvar filename = xhr.target.responseURL.split('/').pop();\r\n\t\tif (TRACE) console.log('...'+filename+' '+Math.round(percentComplete,2)+'% downloaded');\r\n\t}\r\n}\r\n\r\nexport { init, load, LoadRequest };\r\n","/**\r\n * Utilities to help build AltspaceVR apps on CodePen.io.\r\n * @module altspace/utilities/codePen\r\n */\r\n\r\nvar Please = window.Please;\r\nvar Url = window.Url;\r\n\r\nvar name = 'VR CodePen';\r\nvar inTile = window.name && window.name.slice(0, 4) === 'pen-';\r\nvar inVR = !!window.altspace.inClient;\r\nvar inCodePen = !!location.href.match('codepen.io/');\r\n\r\nfunction printDebugInfo() {\r\n\tconsole.log(\"In a tile: \" + inTile);\r\n\tconsole.log(\"In VR: \" + inVR);\r\n}\r\n\r\n/**\r\n * Will stop code exection and post a message informing the user to\r\n * open the example in VR\r\n * @method ensureInVR\r\n * @memberof module:altspace/utilities/codePen\r\n */\r\nfunction ensureInVR() {\r\n\tif (inTile || !inVR) //inTile && inAltspace\r\n\t{\r\n\t\tvar css = document.createElement(\"style\");\r\n\t\tcss.type = \"text/css\";\r\n\t\tcss.innerHTML = \"@import url(https://fonts.googleapis.com/css?family=Open+Sans:800);.altspace-info{text-align:center;font-family:'Open Sans',sans-serif;line-height:.5}.altspace-vr-notice{color:rgba(0,0,0,.7);font-size:5vw}.altspace-pen-name{font-size:7vw}\";\r\n\t\tdocument.head.appendChild(css);\r\n\r\n\t\tdocument.body.style.background = Please.make_color({ seed: getPenId() });\r\n\r\n\t\tvar info = document.createElement(\"div\");\r\n\t\tinfo.className = \"altspace-info\";\r\n\t\tdocument.body.appendChild(info);\r\n\r\n\t\tvar nameEl = document.createElement(\"span\");\r\n\t\tnameEl.className = \"altspace-pen-name\";\r\n\t\tnameEl.innerHTML = '<p>' + name.toUpperCase() + '</p>';\r\n\t\tinfo.appendChild(nameEl);\r\n\r\n\t\tif (inTile) {\r\n\t\t\tvar errorMsg = 'VR mode does not support preview tiles. Stopping code execution.';\r\n\t\t\tconsole.log('ERROR: ' + errorMsg);\r\n\t\t\tthrow new Error(errorMsg);\r\n\t\t}\r\n\r\n\t\tif (!inVR) {\r\n\r\n\t\t\tvar launchEl = document.createElement(\"span\");\r\n\t\t\tlaunchEl.className = \"altspace-vr-notice\";\r\n\t\t\tlaunchEl.innerHTML = '<p>View</p>';\r\n\t\t\tinfo.insertBefore(launchEl, nameEl);\r\n\r\n\t\t\tvar notice = document.createElement(\"span\");\r\n\t\t\tnotice.className = \"altspace-vr-notice\";\r\n\t\t\tnotice.innerHTML = '<p>in <a href=\"http://altvr.com\"> AltspaceVR </a></p>';\r\n\t\t\tinfo.appendChild(notice);\r\n\r\n\r\n\t\t\tvar errorMsg = 'Not in VR mode. Stopping code execution.';\r\n\t\t\tif (inTile) {\r\n\t\t\t\tconsole.log('ERROR: ' + errorMsg);//thrown error message not displayed in console when inTile, log it\r\n\t\t\t}\r\n\t\t\tthrow new Error(errorMsg);\r\n\t\t}\r\n\t\treturn;\r\n\r\n\t}\r\n}\r\n\r\n/**\r\n * Sets the name to be used by ensureInVR()\r\n * @method setName\r\n * @param {String} name\r\n * @memberof module:altspace/utilities/codePen\r\n */\r\nfunction setName(n) {//TODO: A better method for this would be awesome\r\n\tname = n;\r\n}\r\n\r\nfunction getParsedUrl() {\r\n\tvar canonicalElement = document.querySelector('link[rel=canonical]');\r\n\tvar fullUrl = canonicalElement ? canonicalElement.href : window.location.href;\r\n\treturn new Url(fullUrl);\r\n}\r\n\r\n\r\n/**\r\n * Returns the pen ID, useful for setting the sync instanceId.\r\n * @method getPenId\r\n * @return {String}\r\n * @memberof module:altspace/utilities/codePen\r\n */\r\nfunction getPenId() {\r\n\tvar url = getParsedUrl();\r\n\tvar splitPath = url.path.split('/');\r\n\tvar id = splitPath[splitPath.length - 1];\r\n\treturn id;\r\n}\r\n\r\n/**\r\n * Returns the pen author ID, useful for setting the sync authorId.\r\n * @method getAuthorId\r\n * @return {String}\r\n * @memberof module:altspace/utilities/codePen\r\n */\r\nfunction getAuthorId() {\r\n\tvar url = getParsedUrl();\r\n\tvar splitPath = url.path.split('/');\r\n\tvar isTeam = splitPath[1] == 'team';\r\n\tvar id = isTeam ? 'team-' + splitPath[2] : splitPath[1];\r\n\treturn id;\r\n}\r\n\r\nexport { inTile, inVR, inCodePen, ensureInVR, setName, getPenId, getAuthorId, printDebugInfo };\r\n","'use strict';\r\n\r\n/**\r\n* Load an OBJ file and its material definition in one pass.\r\n* @class OBJMTLLoader\r\n* @memberof module:altspace/utilities/shims\r\n*/\r\nclass OBJMTLLoader\r\n{\r\n    /**\r\n    * A function that's passed the result of the OBJMTLLoader.\r\n    * @callback module:altspace/utilities/shims.OBJMTLLoader~LoaderCallback\r\n    * @param {Object3D} object - The loaded object\r\n    */\r\n\r\n    /**\r\n    * Begin loading the definition files.\r\n    * @method load\r\n    * @memberof module:altspace/utilities/shims.OBJMTLLoader\r\n    * @static\r\n    * @param {string} objFile - The URL to the OBJ file\r\n    * @param {string} mtlFile - The URL to the MTL file\r\n    * @param {LoaderCallback} callback - The function called when loading is complete\r\n    */\r\n    load (objFile, mtlFile, callback)\r\n    {\r\n        var mtlLoader = new THREE.MTLLoader()\r\n        var baseUrl = mtlFile.split('/').slice(0, -1).join('/');\r\n        mtlLoader.setBaseUrl(baseUrl + '/');\r\n        mtlLoader.setCrossOrigin(this.crossOrigin);\r\n        mtlLoader.load(mtlFile, function (materials) {\r\n            var objLoader = new THREE.OBJLoader();\r\n            objLoader.setMaterials(materials);\r\n            objLoader.load(objFile, callback);\r\n        });\r\n    }\r\n}\r\n\r\nexport default OBJMTLLoader;\r\n","/**\r\n* The Altspace SDK adds event bubbling to Three.js' events system.\r\n* Simply include the SDK in your app and add a bubbling property to your event to take advantage of this feature.\r\n*\r\n* AltspaceVR cursor events always make use of this bubbling shim.\r\n*\r\n* @example\r\n* var parent = new THREE.Object3D();\r\n* parent.addEventListener('custom', function () {\r\n*     console.log('received custom event');\r\n* });\r\n* var child = new THREE.Object3D();\r\n* parent.add(child);\r\n* child.dispatchEvent({type: 'custom', bubbles: true});\r\n* // Console log shows 'received custom event'\r\n*\r\n* @module altspace/utilities/shims/bubbling\r\n*/\r\n\r\nif(THREE && !altspace.inClient)\r\n{\r\n\tTHREE.EventDispatcher.prototype.dispatchEvent = dispatchEvent;\r\n\tTHREE.Object3D.prototype.dispatchEvent = dispatchEvent;\r\n}\r\n\r\nfunction dispatchEvent( event ) {\r\n\r\n\tvar shouldStopPropagation;\r\n\tvar shouldStopPropagationImmediately;\r\n\r\n\tif ( event.bubbles ) {\r\n\t\tevent.currentTarget = this;\r\n\t\tevent.stopPropagation = function () {\r\n\t\t\tshouldStopPropagation = true;\r\n\t\t}\r\n\r\n\t\tevent.stopImmediatePropagation = function () {\r\n\t\t\tshouldStopPropagationImmediately = true;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tif ( this._listeners ) {\r\n\r\n\t\tvar listeners = this._listeners;\r\n\t\tvar listenerArray = listeners[ event.type ];\r\n\r\n\t\tif ( listenerArray ) {\r\n\t\t\tevent.target = event.target || this;\r\n\r\n\t\t\tvar array = [];\r\n\t\t\tvar length = listenerArray.length;\r\n\r\n\t\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\t\t\t\tarray[ i ] = listenerArray[ i ];\r\n\t\t\t}\r\n\r\n\t\t\tfor ( var i = 0; i < length; i ++ ) {\r\n\t\t\t\tarray[ i ].call( this, event );\r\n\t\t\t\tif ( shouldStopPropagationImmediately ) return;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif ( event.bubbles && this.parent && this.parent.dispatchEvent && ! shouldStopPropagation ) {\r\n\t\tdispatchEvent.call( this.parent, event );\r\n\t}\r\n}\r\n","/**\r\n* @author gavanwilhite / http://gavanwilhite.com\r\n*/\r\n\r\n/**\r\n* The AltspaceDK includes a Behaviors shim that adds Behavior capabilities to\r\n* Three.js.\r\n* It adds methods to Three.js' Scene and Object3D classes which allow you to\r\n* add, remove, retrieve and use Behaviors.\r\n*\r\n* @namespace THREE\r\n*/\r\n\r\n/**\r\n* The AltspaceSDK adds Behavior capabilites to Three.js' Scene class.\r\n* @class Scene\r\n* @memberof THREE\r\n*/\r\n\r\n/**\r\n* Update the behaviors of all the objects in this Scene.\r\n* @instance\r\n* @method updateAllBehaviors\r\n* @memberof THREE.Scene\r\n*/\r\nTHREE.Scene.prototype.updateAllBehaviors = function () {\r\n\r\n\tvar now = performance.now();\r\n\tvar lastNow = this.__lastNow || now;\r\n\r\n\tvar deltaTime = now - lastNow;\r\n\r\n\tvar self = this;\r\n\r\n\t//gather objects first so that behaviors can change the hierarchy during traversal without incident\r\n\tvar objectsWithBehaviors = [];\r\n\r\n\tthis.traverse(function (object3d) {\r\n\r\n\t\tif (object3d.__behaviorList) {\r\n\t\t\tobjectsWithBehaviors.push(object3d);\r\n\t\t}\r\n\r\n\t});\r\n\r\n\tfor (var i = 0, max = objectsWithBehaviors.length; i < max; i++) {\r\n\t\tvar object3d = objectsWithBehaviors[i];\r\n\t\tobject3d.updateBehaviors(deltaTime, self);\r\n\t}\r\n\r\n\tthis.__lastNow = now;\r\n\r\n}\r\n\r\n/**\r\n* The AltspaceSDK adds Behavior capabilites to Three.js' Object3D class.\r\n* @class Object3D\r\n* @memberof THREE\r\n*/\r\n\r\n/**\r\n* Adds the given behavior to this object.\r\n* @instance\r\n* @method addBehavior\r\n* @param {Behavior} behavior Behavior to add.\r\n* @memberof THREE.Object3D\r\n*/\r\nTHREE.Object3D.prototype.addBehavior = function()\r\n{\r\n\tthis.__behaviorList = this.__behaviorList || [];\r\n\tArray.prototype.push.apply(this.__behaviorList, arguments);\r\n}\r\n\r\n/**\r\n* Adds the given behaviors to this object.\r\n* @instance\r\n* @method addBehaviors\r\n* @param {...Behavior} behavior Behavior to add.\r\n* @memberof THREE.Object3D\r\n*/\r\nTHREE.Object3D.prototype.addBehaviors = function()\r\n{\r\n\tthis.__behaviorList = this.__behaviorList || [];\r\n\tArray.prototype.push.apply(this.__behaviorList, arguments);\r\n}\r\n\r\n/**\r\n* Removes the given behavior from this object. The behavior is disposed if\r\n* possible.\r\n* @instance\r\n* @method removeBehavior\r\n* @param {...Behavior} behavior Behavior to remove.\r\n* @memberof THREE.Object3D\r\n*/\r\nTHREE.Object3D.prototype.removeBehavior = function(behavior)\r\n{\r\n\tif (!this.__behaviorList || this.__behaviorList.length === 0) return null;\r\n\r\n\tvar i = this.__behaviorList.indexOf(behavior);\r\n\tif (i !== -1) {\r\n\t\tthis.__behaviorList.splice(i, 1);\r\n\t\ttry {\r\n\r\n\t\t\tif (behavior.dispose) behavior.dispose.call(behavior, this);\r\n\r\n\t\t} catch (error) {\r\n\r\n\t\t\tconsole.group();\r\n\t\t\t(console.error || console.log).call(console, error.stack || error);\r\n\t\t\tconsole.log('[Behavior]');\r\n\t\t\tconsole.log(behavior);\r\n\t\t\tconsole.log('[Object3D]');\r\n\t\t\tconsole.log(this);\r\n\t\t\tconsole.groupEnd();\r\n\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n* Removes all behaviors from this object. The behaviors are disposed if\r\n* possible.\r\n* @instance\r\n* @method removeAllBehaviors\r\n* @memberof THREE.Object3D\r\n*/\r\nTHREE.Object3D.prototype.removeAllBehaviors = function ()\r\n{\r\n\tif (!this.__behaviorList || this.__behaviorList.length === 0) return null;\r\n\r\n\tfor (var i = 0, max = this.__behaviorList.length; i < max; i++) {\r\n\t\tvar behavior = this.__behaviorList[i];\r\n\r\n\t\ttry {\r\n\r\n\t\t\tif (behavior.dispose) behavior.dispose.call(behavior, this);\r\n\r\n\t\t} catch (error) {\r\n\r\n\t\t\tconsole.group();\r\n\t\t\t(console.error || console.log).call(console, error.stack || error);\r\n\t\t\tconsole.log('[Behavior]');\r\n\t\t\tconsole.log(behavior);\r\n\t\t\tconsole.log('[Object3D]');\r\n\t\t\tconsole.log(this);\r\n\t\t\tconsole.groupEnd();\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tthis.__behaviorList.length = 0;\r\n}\r\n\r\n/**\r\n* Retrieve a behavior by type.\r\n* @instance\r\n* @method getBehaviorByType\r\n* @param {String} type\r\n* @returns {Behavior}\r\n* @memberof THREE.Object3D\r\n*/\r\nTHREE.Object3D.prototype.getBehaviorByType = function(type) {\r\n\tif (!this.__behaviorList || this.__behaviorList.length === 0) return null;\r\n\r\n\tfor (var i = 0, max = this.__behaviorList.length; i < max; i++) {\r\n\t\tif (this.__behaviorList[i].type === type)\r\n\t\t\treturn this.__behaviorList[i];\r\n\t}\r\n}\r\n\r\n/**\r\n* Update behaviors on this object.\r\n* @instance\r\n* @method updateBehaviors\r\n* @param {Number} deltaTime Elapsed time in milliseconds\r\n* @memberof THREE.Object3D\r\n*/\r\nTHREE.Object3D.prototype.updateBehaviors = function(deltaTime, scene) {\r\n\r\n\tif (!this.__behaviorList || this.__behaviorList.length === 0) return;\r\n\r\n\tvar toInit = [];\r\n\tvar toUpdate = this.__behaviorList.slice(); // prevent mutation of the behavior list during this loop\r\n\r\n\tfor (var i = 0, max = this.__behaviorList.length; i < max; i++) {\r\n\r\n\t\tvar behavior = this.__behaviorList[i];\r\n\t\tif (!behavior.__isInitialized) toInit.push(behavior);\r\n\r\n\t}\r\n\r\n\t//Awake\r\n\tfor (var i = 0, max = toInit.length; i < max; i++) {\r\n\r\n\t\tvar behavior = toInit[i];\r\n\t\ttry {\r\n\r\n\t\t\tif (behavior.awake) behavior.awake.call(behavior, this, scene);\r\n\r\n\t\t} catch (error) {\r\n\r\n\t\t\tconsole.group();\r\n\t\t\t(console.error || console.log).call(console, error.stack || error);\r\n\t\t\tconsole.log('[Behavior]');\r\n\t\t\tconsole.log(behavior);\r\n\t\t\tconsole.log('[Object3D]');\r\n\t\t\tconsole.log(this);\r\n\t\t\tconsole.groupEnd();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//Start\r\n\tfor (var i = 0, max = toInit.length; i < max; i++) {\r\n\r\n\t\tvar behavior = toInit[i];\r\n\t\ttry {\r\n\r\n\t\t\tif (behavior.start) behavior.start.call(behavior);\r\n\r\n\t\t} catch (error) {\r\n\r\n\t\t\tconsole.group();\r\n\t\t\t(console.error || console.log).call(console, error.stack || error);\r\n\t\t\tconsole.log('[Behavior]');\r\n\t\t\tconsole.log(behavior);\r\n\t\t\tconsole.log('[Object3D]');\r\n\t\t\tconsole.log(this);\r\n\t\t\tconsole.groupEnd();\r\n\r\n\t\t}\r\n\t\tbehavior.__isInitialized = true;\r\n\r\n\t}\r\n\r\n\t//Update\r\n\tfor (var i = 0, max = toUpdate.length; i < max; i++) {\r\n\r\n\t\tvar behavior = toUpdate[i];\r\n\t\ttry {\r\n\r\n\t\t\tif (behavior.update) behavior.update.call(behavior, deltaTime);\r\n\r\n\t\t} catch (error) {\r\n\r\n\t\t\tconsole.group();\r\n\t\t\t(console.error || console.log).call(console, error.stack || error);\r\n\t\t\tconsole.log('[Behavior]');\r\n\t\t\tconsole.log(behavior);\r\n\t\t\tconsole.log('[Object3D]');\r\n\t\t\tconsole.log(this);\r\n\t\t\tconsole.groupEnd();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n","'use strict';\r\n\r\n/**\r\n* The main module for the AltspaceVR SDK.\r\n* @module altspace\r\n*/\r\n\r\n// make sure that the core uses the correct version of the SDK\r\nlet version = VERSION;\r\nif (window.altspace && window.altspace.requestVersion) {\r\n\twindow.altspace.requestVersion(version);\r\n}\r\n\r\n// include source packages\r\nimport * as components from './components/index';\r\nimport * as utilities from './utilities/index';\r\n\r\nexport { components, utilities };\r\n"],"names":["let","this","CursorShim.init","prototypeAccessors","init","Url"],"mappings":"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"}