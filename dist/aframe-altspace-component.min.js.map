{"version":3,"file":"aframe-altspace-component.min.js","sources":["../src/AFrameComponent.js","../src/utilities.js","../src/AltspaceCursorCollider.js","../src/AltspaceTrackedControls.js","../src/index.js"],"sourcesContent":["'use strict';\r\n\r\nclass AFrameComponent\r\n{\r\n\tget schema(){\r\n\t\treturn null;\r\n\t}\r\n\r\n\tinit(){ }\r\n\tupdate(oldData){ }\r\n\tremove(){ }\r\n\ttick(time, timeDelta){ }\r\n\tpause(){ }\r\n\tplay(){ }\r\n\tupdateSchema(data){ }\r\n\r\n}\r\n\r\nfunction flatten(obj)\r\n{\r\n\tlet ret = {};\r\n\tif(!obj.prototype){\r\n\t\tret = Object.assign( {schema: {}}, obj );\r\n\t}\r\n\telse {\r\n\t\tret = Object.assign( flatten(obj.prototype), obj );\r\n\t}\r\n\r\n\tObject.assign(ret.schema, obj.schema);\r\n\treturn ret;\r\n}\r\n\r\nfunction registerComponent(name, cls)\r\n{\r\n\tAFRAME.registerComponent(name, flatten(cls));\r\n}\r\n\r\nexport { AFrameComponent, registerComponent };\r\n","'use strict';\r\n\r\nfunction safeDeepSet(obj, keys, value)\r\n{\r\n\tif(keys.length === 0)\r\n\t\treturn value;\r\n\telse {\r\n\t\tobj[keys[0]] = safeDeepSet(obj[keys[0]] || {}, keys.slice(1), value);\r\n\t\treturn obj;\r\n\t}\r\n}\r\n\r\nexport { safeDeepSet };\r\n","/**\r\n* Enable or disable cursor collision on the object.\r\n* @mixin altspace-cursor-collider\r\n* @memberof altspace\r\n* @prop {boolean} enabled=true - The state of the cursor collider.\r\n*/\r\n\r\n'use strict';\r\n\r\nimport {AFrameComponent} from './AFrameComponent';\r\nimport {safeDeepSet} from './utilities';\r\n\r\n\r\nexport default class AltspaceCursorCollider extends AFrameComponent\r\n{\r\n\tget schema(){\r\n\t\treturn {enabled: {type: 'boolean', default: 'true'}};\r\n\t}\r\n\r\n\tinit()\r\n\t{\r\n\t\tthis.setColliderFlag(this.data.enabled);\r\n\t\tthis.el.addEventListener('model-loaded', (() => {\r\n\t\t\tthis.setColliderFlag(this.data.enabled);\r\n\t\t}).bind(this));\r\n\t}\r\n\r\n\tupdate()\r\n\t{\r\n\t\tthis.setColliderFlag(this.data.enabled);\r\n\t}\r\n\r\n\tsetColliderFlag(state)\r\n\t{\r\n\t\tlet obj = this.el.object3D;\r\n\t\tif(obj){\r\n\t\t\tconsole.log('Setting collider flag to', state);\r\n\t\t\tsafeDeepSet(obj.userData, ['altspace','collider','enabled'], state);\r\n\t\t\tobj.traverse(subobj => {\r\n\t\t\t\tif( subobj instanceof THREE.Mesh ){\r\n\t\t\t\t\tsafeDeepSet(subobj.userData, ['altspace','collider','enabled'], state);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n};\r\n","/**\r\n* Enables tracked control support for A-Frame applications that use the built-in\r\n* `tracked-controls`, `vive-controls` or `hand-controls` components.\r\n* @mixin altspace-tracked-controls\r\n* @memberof altspace\r\n*/\r\n'use strict';\r\n\r\nimport {AFrameComponent} from './AFrameComponent';\r\n\r\nexport default class AltspaceTrackedControls extends AFrameComponent\r\n{\r\n\tinit()\r\n\t{\r\n\t\tthis.gamepadIndex = null;\r\n\t\tthis.trackedControlsSystem = document.querySelector('a-scene').systems['tracked-controls'];\r\n\t\tthis.systemGamepads = 0;\r\n\t\taltspace.getGamepads();\r\n\t}\r\n\r\n\ttick()\r\n\t{\r\n\t\tif (\r\n\t\t\tthis.trackedControlsSystem &&\r\n\t\t\tthis.systemGamepads !== this.trackedControlsSystem.controllers.length &&\r\n\t\t\twindow.altspace && altspace.getGamepads && altspace.getGamepads().length\r\n\t\t) {\r\n\t\t\tvar components = this.el.components;\r\n\t\t\tif (components['paint-controls']) {\r\n\t\t\t\tthis.gamepadIndex = components['paint-controls'].data.hand === 'left' ? 2 : 1;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.gamepadIndex === null && components['hand-controls']) {\r\n\t\t\t\tthis.gamepadIndex = components['hand-controls'].data === 'left' ? 2 : 1;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.gamepadIndex === null && components['vive-controls']) {\r\n\t\t\t\tthis.gamepadIndex = components['vive-controls'].data.hand === 'left' ? 2 : 1;\r\n\t\t\t}\r\n\r\n\t\t\tif (this.gamepadIndex === null && components['tracked-controls']) {\r\n\t\t\t\tthis.gamepadIndex = components['tracked-controls'].data.controller;\r\n\t\t\t}\r\n\r\n\t\t\tthis.el.setAttribute('tracked-controls', 'id', altspace.getGamepads()[this.gamepadIndex].id);\r\n\t\t\tthis.el.setAttribute('tracked-controls', 'controller', 0);\r\n\t\t\tthis.systemGamepads = this.trackedControlsSystem.controllers.length;\r\n\t\t}\r\n\t}\r\n}\r\n","'use strict';\r\n\r\nif (typeof AFRAME === 'undefined') {\r\n  throw new Error('Component attempted to register before AFRAME was available.');\r\n}\r\n\r\nimport {registerComponent} from './AFrameComponent';\r\n\r\nimport AltspaceCursorCollider from './AltspaceCursorCollider';\r\nregisterComponent('altspace-cursor-collider', AltspaceCursorCollider);\r\n\r\nimport AltspaceTrackedControls from './AltspaceTrackedControls';\r\nregisterComponent('altspace-tracked-controls', AltspaceTrackedControls);\r\n\r\nexport {AltspaceCursorCollider};\r\n"],"names":["flatten","obj","let","ret","prototype","Object","assign","schema","registerComponent","name","cls","AFRAME","safeDeepSet","keys","value","length","slice","AFrameComponent","prototypeAccessors","init","update","oldData","remove","tick","time","timeDelta","pause","play","updateSchema","data","AltspaceCursorCollider","enabled","type","default","this","setColliderFlag","el","addEventListener","bind","state","object3D","console","log","userData","traverse","subobj","THREE","Mesh","AltspaceTrackedControls","gamepadIndex","trackedControlsSystem","document","querySelector","systems","systemGamepads","altspace","getGamepads","controllers","window","components","hand","controller","setAttribute","id","Error"],"mappings":"yBAkBA,SAASA,GAAQC,GAEhBC,GAAIC,KASJ,OAJCA,GAJGF,EAAIG,UAIDC,OAAOC,OAAQN,EAAQC,EAAIG,WAAYH,GAHvCI,OAAOC,QAASC,WAAaN,GAMpCI,OAAOC,OAAOH,EAAII,OAAQN,EAAIM,QACvBJ,EAGR,QAASK,GAAkBC,EAAMC,GAEhCC,OAAOH,kBAAkBC,EAAMT,EAAQU,IChCxC,QAASE,GAAYX,EAAKY,EAAMC,GAE/B,MAAmB,KAAhBD,EAAKE,OACAD,GAEPb,EAAIY,EAAK,IAAMD,EAAYX,EAAIY,EAAK,QAAWA,EAAKG,MAAM,GAAIF,GACvDb,GDNT,GAAMgB,GACN,0BAAAC,GACCX,sBACA,MAAQ,OAGTU,YAACE,kBACDF,YAACG,gBAAOC,KACRJ,YAACK,oBACDL,YAACM,cAAKC,EAAMC,KACZR,YAACS,mBACDT,YAACU,kBACDV,YAACW,sBAAaC,2CEPd,IAMqBC,eACrB,oJAAAZ,GACCX,sBACC,OAAQwB,SAAUC,KAAM,UAAWC,QAAS,UAG7CH,YAAAX,0BAECe,MAAKC,gBAAgBD,KAAKL,KAAKE,SAC/BG,KAAKE,GAAGC,iBAAiB,eAAgB,WACxCH,EAAKC,gBAAgBD,EAAKL,KAAKE,UAC7BO,KAAKJ,QAGTJ,YAAAV,kBAECc,KAAKC,gBAAgBD,KAAKL,KAAKE,UAGhCD,YAAAK,yBAAgBI,GAEfrC,GAAID,GAAMiC,KAAKE,GAAGI,QACfvC,KACFwC,QAAQC,IAAI,2BAA4BH,GACxC3B,EAAYX,EAAI0C,UAAW,WAAW,WAAW,WAAYJ,GAC7DtC,EAAI2C,SAAS,SAAAC,GACRA,YAAkBC,OAAMC,MAC3BnC,EAAYiC,EAAOF,UAAW,WAAW,WAAW,WAAYJ,iDA3BjBtB,GCH/B+B,cACrB,mIAAAA,YACC7B,gBAECe,KAAKe,aAAe,KACpBf,KAAKgB,sBAAwBC,SAASC,cAAc,WAAWC,QAAQ,oBACvEnB,KAAKoB,eAAiB,EACtBC,SAASC,eAGVR,YAAAzB,gBAEC,GACCW,KAAKgB,uBACLhB,KAAKoB,iBAAmBpB,KAAKgB,sBAAsBO,YAAY1C,QAC/D2C,OAAOH,UAAYA,SAASC,aAAeD,SAASC,cAAczC,OACjE,CACD,GAAI4C,GAAazB,KAAKE,GAAGuB,UACrBA,GAAW,oBACdzB,KAAKe,aAA0D,SAA3CU,EAAW,kBAAkB9B,KAAK+B,KAAkB,EAAI,GAGnD,OAAtB1B,KAAKe,cAAyBU,EAAW,mBAC5CzB,KAAKe,aAAoD,SAArCU,EAAW,iBAAiB9B,KAAkB,EAAI,GAG7C,OAAtBK,KAAKe,cAAyBU,EAAW,mBAC5CzB,KAAKe,aAAyD,SAA1CU,EAAW,iBAAiB9B,KAAK+B,KAAkB,EAAI,GAGlD,OAAtB1B,KAAKe,cAAyBU,EAAW,sBAC5CzB,KAAKe,aAAeU,EAAW,oBAAoB9B,KAAKgC,YAGzD3B,KAAKE,GAAG0B,aAAa,mBAAoB,KAAMP,SAASC,cAActB,KAAKe,cAAcc,IACzF7B,KAAKE,GAAG0B,aAAa,mBAAoB,aAAc,GACvD5B,KAAKoB,eAAiBpB,KAAKgB,sBAAsBO,YAAY1C,YApCXE,ECRrD,IAAsB,mBAAXN,QACT,KAAM,IAAIqD,OAAM,+DAGlBxD,GAGkB,2BAA4BsB,GAE9CtB,EACkB,4BAA6BwC"}